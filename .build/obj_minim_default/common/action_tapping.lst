   1               		.file	"action_tapping.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.debug_waiting_buffer,"ax",@progbits
  12               	debug_waiting_buffer:
  13               	.LFB15:
  14               		.file 1 "tmk_core/common/action_tapping.c"
   1:tmk_core/common/action_tapping.c **** #include <stdint.h>
   2:tmk_core/common/action_tapping.c **** #include <stdbool.h>
   3:tmk_core/common/action_tapping.c **** #include "action.h"
   4:tmk_core/common/action_tapping.c **** #include "action_layer.h"
   5:tmk_core/common/action_tapping.c **** #include "action_tapping.h"
   6:tmk_core/common/action_tapping.c **** #include "keycode.h"
   7:tmk_core/common/action_tapping.c **** #include "timer.h"
   8:tmk_core/common/action_tapping.c **** 
   9:tmk_core/common/action_tapping.c **** #ifdef DEBUG_ACTION
  10:tmk_core/common/action_tapping.c **** #    include "debug.h"
  11:tmk_core/common/action_tapping.c **** #else
  12:tmk_core/common/action_tapping.c **** #    include "nodebug.h"
  13:tmk_core/common/action_tapping.c **** #endif
  14:tmk_core/common/action_tapping.c **** 
  15:tmk_core/common/action_tapping.c **** #ifndef NO_ACTION_TAPPING
  16:tmk_core/common/action_tapping.c **** 
  17:tmk_core/common/action_tapping.c **** #    define IS_TAPPING() !IS_NOEVENT(tapping_key.event)
  18:tmk_core/common/action_tapping.c **** #    define IS_TAPPING_PRESSED() (IS_TAPPING() && tapping_key.event.pressed)
  19:tmk_core/common/action_tapping.c **** #    define IS_TAPPING_RELEASED() (IS_TAPPING() && !tapping_key.event.pressed)
  20:tmk_core/common/action_tapping.c **** #    define IS_TAPPING_KEY(k) (IS_TAPPING() && KEYEQ(tapping_key.event.key, (k)))
  21:tmk_core/common/action_tapping.c **** 
  22:tmk_core/common/action_tapping.c **** __attribute__((weak)) uint16_t get_tapping_term(uint16_t keycode) { return TAPPING_TERM; }
  23:tmk_core/common/action_tapping.c **** 
  24:tmk_core/common/action_tapping.c **** #    ifdef TAPPING_TERM_PER_KEY
  25:tmk_core/common/action_tapping.c **** #        define WITHIN_TAPPING_TERM(e) (TIMER_DIFF_16(e.time, tapping_key.event.time) < get_tapping
  26:tmk_core/common/action_tapping.c **** #    else
  27:tmk_core/common/action_tapping.c **** #        define WITHIN_TAPPING_TERM(e) (TIMER_DIFF_16(e.time, tapping_key.event.time) < TAPPING_TER
  28:tmk_core/common/action_tapping.c **** #    endif
  29:tmk_core/common/action_tapping.c **** 
  30:tmk_core/common/action_tapping.c **** static keyrecord_t tapping_key                         = {};
  31:tmk_core/common/action_tapping.c **** static keyrecord_t waiting_buffer[WAITING_BUFFER_SIZE] = {};
  32:tmk_core/common/action_tapping.c **** static uint8_t     waiting_buffer_head                 = 0;
  33:tmk_core/common/action_tapping.c **** static uint8_t     waiting_buffer_tail                 = 0;
  34:tmk_core/common/action_tapping.c **** 
  35:tmk_core/common/action_tapping.c **** static bool process_tapping(keyrecord_t *record);
  36:tmk_core/common/action_tapping.c **** static bool waiting_buffer_enq(keyrecord_t record);
  37:tmk_core/common/action_tapping.c **** static void waiting_buffer_clear(void);
  38:tmk_core/common/action_tapping.c **** static bool waiting_buffer_typed(keyevent_t event);
  39:tmk_core/common/action_tapping.c **** static bool waiting_buffer_has_anykey_pressed(void);
  40:tmk_core/common/action_tapping.c **** static void waiting_buffer_scan_tap(void);
  41:tmk_core/common/action_tapping.c **** static void debug_tapping_key(void);
  42:tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void);
  43:tmk_core/common/action_tapping.c **** 
  44:tmk_core/common/action_tapping.c **** /** \brief Action Tapping Process
  45:tmk_core/common/action_tapping.c ****  *
  46:tmk_core/common/action_tapping.c ****  * FIXME: Needs doc
  47:tmk_core/common/action_tapping.c ****  */
  48:tmk_core/common/action_tapping.c **** void action_tapping_process(keyrecord_t record) {
  49:tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
  50:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
  51:tmk_core/common/action_tapping.c ****             debug("processed: ");
  52:tmk_core/common/action_tapping.c ****             debug_record(record);
  53:tmk_core/common/action_tapping.c ****             debug("\n");
  54:tmk_core/common/action_tapping.c ****         }
  55:tmk_core/common/action_tapping.c ****     } else {
  56:tmk_core/common/action_tapping.c ****         if (!waiting_buffer_enq(record)) {
  57:tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
  58:tmk_core/common/action_tapping.c ****             debug("OVERFLOW: CLEAR ALL STATES\n");
  59:tmk_core/common/action_tapping.c ****             clear_keyboard();
  60:tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
  61:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
  62:tmk_core/common/action_tapping.c ****         }
  63:tmk_core/common/action_tapping.c ****     }
  64:tmk_core/common/action_tapping.c **** 
  65:tmk_core/common/action_tapping.c ****     // process waiting_buffer
  66:tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event) && waiting_buffer_head != waiting_buffer_tail) {
  67:tmk_core/common/action_tapping.c ****         debug("---- action_exec: process waiting_buffer -----\n");
  68:tmk_core/common/action_tapping.c ****     }
  69:tmk_core/common/action_tapping.c ****     for (; waiting_buffer_tail != waiting_buffer_head; waiting_buffer_tail = (waiting_buffer_tail +
  70:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
  71:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
  72:tmk_core/common/action_tapping.c ****             debug_dec(waiting_buffer_tail);
  73:tmk_core/common/action_tapping.c ****             debug("] = ");
  74:tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]);
  75:tmk_core/common/action_tapping.c ****             debug("\n\n");
  76:tmk_core/common/action_tapping.c ****         } else {
  77:tmk_core/common/action_tapping.c ****             break;
  78:tmk_core/common/action_tapping.c ****         }
  79:tmk_core/common/action_tapping.c ****     }
  80:tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event)) {
  81:tmk_core/common/action_tapping.c ****         debug("\n");
  82:tmk_core/common/action_tapping.c ****     }
  83:tmk_core/common/action_tapping.c **** }
  84:tmk_core/common/action_tapping.c **** 
  85:tmk_core/common/action_tapping.c **** /** \brief Tapping
  86:tmk_core/common/action_tapping.c ****  *
  87:tmk_core/common/action_tapping.c ****  * Rule: Tap key is typed(pressed and released) within TAPPING_TERM.
  88:tmk_core/common/action_tapping.c ****  *       (without interfering by typing other key)
  89:tmk_core/common/action_tapping.c ****  */
  90:tmk_core/common/action_tapping.c **** /* return true when key event is processed or consumed. */
  91:tmk_core/common/action_tapping.c **** bool process_tapping(keyrecord_t *keyp) {
  92:tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
  93:tmk_core/common/action_tapping.c **** 
  94:tmk_core/common/action_tapping.c ****     // if tapping
  95:tmk_core/common/action_tapping.c ****     if (IS_TAPPING_PRESSED()) {
  96:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
  97:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
  98:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
  99:tmk_core/common/action_tapping.c ****                     // first tap!
 100:tmk_core/common/action_tapping.c ****                     debug("Tapping: First tap(0->1).\n");
 101:tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 102:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 103:tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 104:tmk_core/common/action_tapping.c **** 
 105:tmk_core/common/action_tapping.c ****                     // copy tapping state
 106:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 107:tmk_core/common/action_tapping.c ****                     // enqueue
 108:tmk_core/common/action_tapping.c ****                     return false;
 109:tmk_core/common/action_tapping.c ****                 }
 110:tmk_core/common/action_tapping.c ****                 /* Process a key typed within TAPPING_TERM
 111:tmk_core/common/action_tapping.c ****                  * This can register the key before settlement of tapping,
 112:tmk_core/common/action_tapping.c ****                  * useful for long TAPPING_TERM but may prevent fast typing.
 113:tmk_core/common/action_tapping.c ****                  */
 114:tmk_core/common/action_tapping.c **** #    if defined(TAPPING_TERM_PER_KEY) || (!defined(PER_KEY_TAPPING_TERM) && TAPPING_TERM >= 500) ||
 115:tmk_core/common/action_tapping.c **** #        ifdef TAPPING_TERM_PER_KEY
 116:tmk_core/common/action_tapping.c ****                 else if ((get_tapping_term(get_event_keycode(tapping_key.event)) >= 500) && IS_RELE
 117:tmk_core/common/action_tapping.c **** #        else
 118:tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && waiting_buffer_typed(event))
 119:tmk_core/common/action_tapping.c **** #        endif
 120:tmk_core/common/action_tapping.c ****                 {
 121:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 122:tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 123:tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 124:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 125:tmk_core/common/action_tapping.c ****                     // enqueue
 126:tmk_core/common/action_tapping.c ****                     return false;
 127:tmk_core/common/action_tapping.c ****                 }
 128:tmk_core/common/action_tapping.c **** #    endif
 129:tmk_core/common/action_tapping.c ****                 /* Process release event of a key pressed before tapping starts
 130:tmk_core/common/action_tapping.c ****                  * Without this unexpected repeating will occur with having fast repeating setting
 131:tmk_core/common/action_tapping.c ****                  * https://github.com/tmk/tmk_keyboard/issues/60
 132:tmk_core/common/action_tapping.c ****                  */
 133:tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && !waiting_buffer_typed(event)) {
 134:tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 135:tmk_core/common/action_tapping.c ****                     action_t action = layer_switch_get_action(event.key);
 136:tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 137:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 138:tmk_core/common/action_tapping.c ****                         case ACT_RMODS:
 139:tmk_core/common/action_tapping.c ****                             if (action.key.mods && !action.key.code) return false;
 140:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 141:tmk_core/common/action_tapping.c ****                             break;
 142:tmk_core/common/action_tapping.c ****                         case ACT_LMODS_TAP:
 143:tmk_core/common/action_tapping.c ****                         case ACT_RMODS_TAP:
 144:tmk_core/common/action_tapping.c ****                             if (action.key.mods && keyp->tap.count == 0) return false;
 145:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 146:tmk_core/common/action_tapping.c ****                             break;
 147:tmk_core/common/action_tapping.c ****                     }
 148:tmk_core/common/action_tapping.c ****                     // Release of key should be process immediately.
 149:tmk_core/common/action_tapping.c ****                     debug("Tapping: release event of a key pressed before tapping\n");
 150:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 151:tmk_core/common/action_tapping.c ****                     return true;
 152:tmk_core/common/action_tapping.c ****                 } else {
 153:tmk_core/common/action_tapping.c ****                     // set interrupted flag when other key preesed during tapping
 154:tmk_core/common/action_tapping.c ****                     if (event.pressed) {
 155:tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 156:tmk_core/common/action_tapping.c ****                     }
 157:tmk_core/common/action_tapping.c ****                     // enqueue
 158:tmk_core/common/action_tapping.c ****                     return false;
 159:tmk_core/common/action_tapping.c ****                 }
 160:tmk_core/common/action_tapping.c ****             }
 161:tmk_core/common/action_tapping.c ****             // tap_count > 0
 162:tmk_core/common/action_tapping.c ****             else {
 163:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 164:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 165:tmk_core/common/action_tapping.c ****                     debug_dec(tapping_key.tap.count);
 166:tmk_core/common/action_tapping.c ****                     debug(")\n");
 167:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 168:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 169:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 170:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 171:tmk_core/common/action_tapping.c ****                     return true;
 172:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key) && event.pressed) {
 173:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 174:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 175:tmk_core/common/action_tapping.c ****                         // unregister key
 176:tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){.tap = tapping_key.tap, .event.key = tapping_
 177:tmk_core/common/action_tapping.c ****                     } else {
 178:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last tap(1).\n");
 179:tmk_core/common/action_tapping.c ****                     }
 180:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 181:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 182:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 183:tmk_core/common/action_tapping.c ****                     return true;
 184:tmk_core/common/action_tapping.c ****                 } else {
 185:tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 186:tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 187:tmk_core/common/action_tapping.c ****                     }
 188:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 189:tmk_core/common/action_tapping.c ****                     return true;
 190:tmk_core/common/action_tapping.c ****                 }
 191:tmk_core/common/action_tapping.c ****             }
 192:tmk_core/common/action_tapping.c ****         }
 193:tmk_core/common/action_tapping.c ****         // after TAPPING_TERM
 194:tmk_core/common/action_tapping.c ****         else {
 195:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 196:tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 197:tmk_core/common/action_tapping.c ****                 debug_event(event);
 198:tmk_core/common/action_tapping.c ****                 debug("\n");
 199:tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 200:tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 201:tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 202:tmk_core/common/action_tapping.c ****                 return false;
 203:tmk_core/common/action_tapping.c ****             } else {
 204:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 205:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 206:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 207:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 208:tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 209:tmk_core/common/action_tapping.c ****                     return true;
 210:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key) && event.pressed) {
 211:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 212:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 213:tmk_core/common/action_tapping.c ****                         // unregister key
 214:tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){.tap = tapping_key.tap, .event.key = tapping_
 215:tmk_core/common/action_tapping.c ****                     } else {
 216:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last timeout tap(1).\n");
 217:tmk_core/common/action_tapping.c ****                     }
 218:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 219:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 220:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 221:tmk_core/common/action_tapping.c ****                     return true;
 222:tmk_core/common/action_tapping.c ****                 } else {
 223:tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 224:tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last timeout tap(>0).\n");
 225:tmk_core/common/action_tapping.c ****                     }
 226:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 227:tmk_core/common/action_tapping.c ****                     return true;
 228:tmk_core/common/action_tapping.c ****                 }
 229:tmk_core/common/action_tapping.c ****             }
 230:tmk_core/common/action_tapping.c ****         }
 231:tmk_core/common/action_tapping.c ****     } else if (IS_TAPPING_RELEASED()) {
 232:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 233:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 234:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 235:tmk_core/common/action_tapping.c **** #    ifndef TAPPING_FORCE_HOLD
 236:tmk_core/common/action_tapping.c ****                     if (!tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 237:tmk_core/common/action_tapping.c ****                         // sequential tap.
 238:tmk_core/common/action_tapping.c ****                         keyp->tap = tapping_key.tap;
 239:tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 240:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 241:tmk_core/common/action_tapping.c ****                         debug_dec(keyp->tap.count);
 242:tmk_core/common/action_tapping.c ****                         debug(")\n");
 243:tmk_core/common/action_tapping.c ****                         process_record(keyp);
 244:tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 245:tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 246:tmk_core/common/action_tapping.c ****                         return true;
 247:tmk_core/common/action_tapping.c ****                     }
 248:tmk_core/common/action_tapping.c **** #    endif
 249:tmk_core/common/action_tapping.c ****                     // FIX: start new tap again
 250:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 251:tmk_core/common/action_tapping.c ****                     return true;
 252:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 253:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 254:tmk_core/common/action_tapping.c ****                     debug("Tapping: Start with interfering other tap.\n");
 255:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 256:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 257:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 258:tmk_core/common/action_tapping.c ****                     return true;
 259:tmk_core/common/action_tapping.c ****                 } else {
 260:tmk_core/common/action_tapping.c ****                     // should none in buffer
 261:tmk_core/common/action_tapping.c ****                     // FIX: interrupted when other key is pressed
 262:tmk_core/common/action_tapping.c ****                     tapping_key.tap.interrupted = true;
 263:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 264:tmk_core/common/action_tapping.c ****                     return true;
 265:tmk_core/common/action_tapping.c ****                 }
 266:tmk_core/common/action_tapping.c ****             } else {
 267:tmk_core/common/action_tapping.c ****                 if (!IS_NOEVENT(event)) debug("Tapping: other key just after tap.\n");
 268:tmk_core/common/action_tapping.c ****                 process_record(keyp);
 269:tmk_core/common/action_tapping.c ****                 return true;
 270:tmk_core/common/action_tapping.c ****             }
 271:tmk_core/common/action_tapping.c ****         } else {
 272:tmk_core/common/action_tapping.c ****             // FIX: process_action here?
 273:tmk_core/common/action_tapping.c ****             // timeout. no sequential tap.
 274:tmk_core/common/action_tapping.c ****             debug("Tapping: End(Timeout after releasing last tap): ");
 275:tmk_core/common/action_tapping.c ****             debug_event(event);
 276:tmk_core/common/action_tapping.c ****             debug("\n");
 277:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 278:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 279:tmk_core/common/action_tapping.c ****             return false;
 280:tmk_core/common/action_tapping.c ****         }
 281:tmk_core/common/action_tapping.c ****     }
 282:tmk_core/common/action_tapping.c ****     // not tapping state
 283:tmk_core/common/action_tapping.c ****     else {
 284:tmk_core/common/action_tapping.c ****         if (event.pressed && is_tap_key(event.key)) {
 285:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 286:tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 287:tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 288:tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 289:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 290:tmk_core/common/action_tapping.c ****             return true;
 291:tmk_core/common/action_tapping.c ****         } else {
 292:tmk_core/common/action_tapping.c ****             process_record(keyp);
 293:tmk_core/common/action_tapping.c ****             return true;
 294:tmk_core/common/action_tapping.c ****         }
 295:tmk_core/common/action_tapping.c ****     }
 296:tmk_core/common/action_tapping.c **** }
 297:tmk_core/common/action_tapping.c **** 
 298:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer enq
 299:tmk_core/common/action_tapping.c ****  *
 300:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 301:tmk_core/common/action_tapping.c ****  */
 302:tmk_core/common/action_tapping.c **** bool waiting_buffer_enq(keyrecord_t record) {
 303:tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 304:tmk_core/common/action_tapping.c ****         return true;
 305:tmk_core/common/action_tapping.c ****     }
 306:tmk_core/common/action_tapping.c **** 
 307:tmk_core/common/action_tapping.c ****     if ((waiting_buffer_head + 1) % WAITING_BUFFER_SIZE == waiting_buffer_tail) {
 308:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 309:tmk_core/common/action_tapping.c ****         return false;
 310:tmk_core/common/action_tapping.c ****     }
 311:tmk_core/common/action_tapping.c **** 
 312:tmk_core/common/action_tapping.c ****     waiting_buffer[waiting_buffer_head] = record;
 313:tmk_core/common/action_tapping.c ****     waiting_buffer_head                 = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 314:tmk_core/common/action_tapping.c **** 
 315:tmk_core/common/action_tapping.c ****     debug("waiting_buffer_enq: ");
 316:tmk_core/common/action_tapping.c ****     debug_waiting_buffer();
 317:tmk_core/common/action_tapping.c ****     return true;
 318:tmk_core/common/action_tapping.c **** }
 319:tmk_core/common/action_tapping.c **** 
 320:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer clear
 321:tmk_core/common/action_tapping.c ****  *
 322:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 323:tmk_core/common/action_tapping.c ****  */
 324:tmk_core/common/action_tapping.c **** void waiting_buffer_clear(void) {
 325:tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 326:tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 327:tmk_core/common/action_tapping.c **** }
 328:tmk_core/common/action_tapping.c **** 
 329:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer typed
 330:tmk_core/common/action_tapping.c ****  *
 331:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 332:tmk_core/common/action_tapping.c ****  */
 333:tmk_core/common/action_tapping.c **** bool waiting_buffer_typed(keyevent_t event) {
 334:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 335:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 336:tmk_core/common/action_tapping.c ****             return true;
 337:tmk_core/common/action_tapping.c ****         }
 338:tmk_core/common/action_tapping.c ****     }
 339:tmk_core/common/action_tapping.c ****     return false;
 340:tmk_core/common/action_tapping.c **** }
 341:tmk_core/common/action_tapping.c **** 
 342:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer has anykey pressed
 343:tmk_core/common/action_tapping.c ****  *
 344:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 345:tmk_core/common/action_tapping.c ****  */
 346:tmk_core/common/action_tapping.c **** __attribute__((unused)) bool waiting_buffer_has_anykey_pressed(void) {
 347:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 348:tmk_core/common/action_tapping.c ****         if (waiting_buffer[i].event.pressed) return true;
 349:tmk_core/common/action_tapping.c ****     }
 350:tmk_core/common/action_tapping.c ****     return false;
 351:tmk_core/common/action_tapping.c **** }
 352:tmk_core/common/action_tapping.c **** 
 353:tmk_core/common/action_tapping.c **** /** \brief Scan buffer for tapping
 354:tmk_core/common/action_tapping.c ****  *
 355:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 356:tmk_core/common/action_tapping.c ****  */
 357:tmk_core/common/action_tapping.c **** void waiting_buffer_scan_tap(void) {
 358:tmk_core/common/action_tapping.c ****     // tapping already is settled
 359:tmk_core/common/action_tapping.c ****     if (tapping_key.tap.count > 0) return;
 360:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 361:tmk_core/common/action_tapping.c ****     if (!tapping_key.event.pressed) return;
 362:tmk_core/common/action_tapping.c **** 
 363:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 364:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 365:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 366:tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 367:tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 368:tmk_core/common/action_tapping.c **** 
 369:tmk_core/common/action_tapping.c ****             debug("waiting_buffer_scan_tap: found at [");
 370:tmk_core/common/action_tapping.c ****             debug_dec(i);
 371:tmk_core/common/action_tapping.c ****             debug("]\n");
 372:tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 373:tmk_core/common/action_tapping.c ****             return;
 374:tmk_core/common/action_tapping.c ****         }
 375:tmk_core/common/action_tapping.c ****     }
 376:tmk_core/common/action_tapping.c **** }
 377:tmk_core/common/action_tapping.c **** 
 378:tmk_core/common/action_tapping.c **** /** \brief Tapping key debug print
 379:tmk_core/common/action_tapping.c ****  *
 380:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 381:tmk_core/common/action_tapping.c ****  */
 382:tmk_core/common/action_tapping.c **** static void debug_tapping_key(void) {
 383:tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY=");
 384:tmk_core/common/action_tapping.c ****     debug_record(tapping_key);
 385:tmk_core/common/action_tapping.c ****     debug("\n");
 386:tmk_core/common/action_tapping.c **** }
 387:tmk_core/common/action_tapping.c **** 
 388:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer debug print
 389:tmk_core/common/action_tapping.c ****  *
 390:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 391:tmk_core/common/action_tapping.c ****  */
 392:tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void) {
  15               		.loc 1 392 40 view -0
  16               		.cfi_startproc
  17 0000 CF93      		push r28
  18               	.LCFI0:
  19               		.cfi_def_cfa_offset 3
  20               		.cfi_offset 28, -2
  21 0002 DF93      		push r29
  22               	.LCFI1:
  23               		.cfi_def_cfa_offset 4
  24               		.cfi_offset 29, -3
  25               	/* prologue: function */
  26               	/* frame size = 0 */
  27               	/* stack size = 2 */
  28               	.L__stack_usage = 2
 393:tmk_core/common/action_tapping.c ****     debug("{ ");
  29               		.loc 1 393 16 view .LVU1
 394:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  30               		.loc 1 394 5 view .LVU2
  31               	.LBB3:
  32               		.loc 1 394 10 view .LVU3
  33               		.loc 1 394 18 is_stmt 0 view .LVU4
  34 0004 C091 0000 		lds r28,waiting_buffer_tail
  35               	.LVL0:
  36               	.L2:
  37               		.loc 1 394 43 is_stmt 1 discriminator 1 view .LVU5
  38               		.loc 1 394 5 is_stmt 0 discriminator 1 view .LVU6
  39 0008 8091 0000 		lds r24,waiting_buffer_head
  40 000c 8C13      		cpse r24,r28
  41 000e 00C0      		rjmp .L3
  42               	/* epilogue start */
  43               	.LBE3:
 395:tmk_core/common/action_tapping.c ****         debug("[");
 396:tmk_core/common/action_tapping.c ****         debug_dec(i);
 397:tmk_core/common/action_tapping.c ****         debug("]=");
 398:tmk_core/common/action_tapping.c ****         debug_record(waiting_buffer[i]);
 399:tmk_core/common/action_tapping.c ****         debug(" ");
 400:tmk_core/common/action_tapping.c ****     }
 401:tmk_core/common/action_tapping.c ****     debug("}\n");
 402:tmk_core/common/action_tapping.c **** }
  44               		.loc 1 402 1 view .LVU7
  45 0010 DF91      		pop r29
  46 0012 CF91      		pop r28
  47               	.LVL1:
  48               		.loc 1 402 1 view .LVU8
  49 0014 0895      		ret
  50               	.LVL2:
  51               	.L3:
  52               	.LBB4:
 395:tmk_core/common/action_tapping.c ****         debug("[");
  53               		.loc 1 395 19 is_stmt 1 discriminator 3 view .LVU9
 396:tmk_core/common/action_tapping.c ****         debug("]=");
  54               		.loc 1 396 21 discriminator 3 view .LVU10
 397:tmk_core/common/action_tapping.c ****         debug_record(waiting_buffer[i]);
  55               		.loc 1 397 20 discriminator 3 view .LVU11
 398:tmk_core/common/action_tapping.c ****         debug(" ");
  56               		.loc 1 398 9 discriminator 3 view .LVU12
  57 0016 D0E0      		ldi r29,0
  58 0018 CE01      		movw r24,r28
  59 001a 66E0      		ldi r22,lo8(6)
  60 001c 70E0      		ldi r23,0
  61 001e 0E94 0000 		call __mulhi3
  62 0022 FC01      		movw r30,r24
  63 0024 E050      		subi r30,lo8(-(waiting_buffer))
  64 0026 F040      		sbci r31,hi8(-(waiting_buffer))
  65 0028 4081      		ld r20,Z
  66 002a 5181      		ldd r21,Z+1
  67 002c 6281      		ldd r22,Z+2
  68 002e 7381      		ldd r23,Z+3
  69 0030 8481      		ldd r24,Z+4
  70 0032 9581      		ldd r25,Z+5
  71 0034 0E94 0000 		call debug_record
  72               	.LVL3:
 399:tmk_core/common/action_tapping.c ****     }
  73               		.loc 1 399 19 discriminator 3 view .LVU13
 394:tmk_core/common/action_tapping.c ****         debug("[");
  74               		.loc 1 394 69 discriminator 3 view .LVU14
 394:tmk_core/common/action_tapping.c ****         debug("[");
  75               		.loc 1 394 76 is_stmt 0 discriminator 3 view .LVU15
  76 0038 2196      		adiw r28,1
  77               	.LVL4:
 394:tmk_core/common/action_tapping.c ****         debug("[");
  78               		.loc 1 394 71 discriminator 3 view .LVU16
  79 003a C770      		andi r28,lo8(7)
 394:tmk_core/common/action_tapping.c ****         debug("[");
  80               		.loc 1 394 71 discriminator 3 view .LVU17
  81 003c 00C0      		rjmp .L2
  82               	.LBE4:
  83               		.cfi_endproc
  84               	.LFE15:
  86               		.section	.text.debug_tapping_key,"ax",@progbits
  88               	debug_tapping_key:
  89               	.LFB14:
 382:tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY=");
  90               		.loc 1 382 37 is_stmt 1 view -0
  91               		.cfi_startproc
  92               	/* prologue: function */
  93               	/* frame size = 0 */
  94               	/* stack size = 0 */
  95               	.L__stack_usage = 0
 383:tmk_core/common/action_tapping.c ****     debug_record(tapping_key);
  96               		.loc 1 383 26 view .LVU19
 384:tmk_core/common/action_tapping.c ****     debug("\n");
  97               		.loc 1 384 5 view .LVU20
  98 0000 4091 0000 		lds r20,tapping_key
  99 0004 5091 0000 		lds r21,tapping_key+1
 100 0008 6091 0000 		lds r22,tapping_key+2
 101 000c 7091 0000 		lds r23,tapping_key+3
 102 0010 8091 0000 		lds r24,tapping_key+4
 103 0014 9091 0000 		lds r25,tapping_key+5
 104 0018 0C94 0000 		jmp debug_record
 105               	.LVL5:
 106               		.cfi_endproc
 107               	.LFE14:
 109               		.section	.text.waiting_buffer_scan_tap,"ax",@progbits
 111               	waiting_buffer_scan_tap:
 112               	.LFB13:
 357:tmk_core/common/action_tapping.c ****     // tapping already is settled
 113               		.loc 1 357 36 view -0
 114               		.cfi_startproc
 115 0000 FF92      		push r15
 116               	.LCFI2:
 117               		.cfi_def_cfa_offset 3
 118               		.cfi_offset 15, -2
 119 0002 0F93      		push r16
 120               	.LCFI3:
 121               		.cfi_def_cfa_offset 4
 122               		.cfi_offset 16, -3
 123 0004 1F93      		push r17
 124               	.LCFI4:
 125               		.cfi_def_cfa_offset 5
 126               		.cfi_offset 17, -4
 127 0006 CF93      		push r28
 128               	.LCFI5:
 129               		.cfi_def_cfa_offset 6
 130               		.cfi_offset 28, -5
 131 0008 DF93      		push r29
 132               	.LCFI6:
 133               		.cfi_def_cfa_offset 7
 134               		.cfi_offset 29, -6
 135               	/* prologue: function */
 136               	/* frame size = 0 */
 137               	/* stack size = 5 */
 138               	.L__stack_usage = 5
 359:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 139               		.loc 1 359 5 view .LVU22
 359:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 140               		.loc 1 359 31 is_stmt 0 view .LVU23
 141 000a 8091 0000 		lds r24,tapping_key+5
 142 000e 807F      		andi r24,lo8(-16)
 359:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 143               		.loc 1 359 8 view .LVU24
 144 0010 01F4      		brne .L5
 361:tmk_core/common/action_tapping.c **** 
 145               		.loc 1 361 5 is_stmt 1 view .LVU25
 361:tmk_core/common/action_tapping.c **** 
 146               		.loc 1 361 8 is_stmt 0 view .LVU26
 147 0012 8091 0000 		lds r24,tapping_key+2
 148 0016 8823      		tst r24
 149 0018 01F0      		breq .L5
 363:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 150               		.loc 1 363 5 is_stmt 1 view .LVU27
 151               	.LBB8:
 363:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 152               		.loc 1 363 10 view .LVU28
 363:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 153               		.loc 1 363 18 is_stmt 0 view .LVU29
 154 001a 2091 0000 		lds r18,waiting_buffer_tail
 155               	.LVL6:
 363:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 156               		.loc 1 363 45 view .LVU30
 157 001e 0091 0000 		lds r16,waiting_buffer_head
 364:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 158               		.loc 1 364 13 view .LVU31
 159 0022 4091 0000 		lds r20,tapping_key
 160 0026 1091 0000 		lds r17,tapping_key+1
 161 002a E091 0000 		lds r30,tapping_key+3
 162 002e F091 0000 		lds r31,tapping_key+3+1
 163 0032 F42E      		mov r15,r20
 164 0034 F122      		and r15,r17
 165 0036 EF01      		movw r28,r30
 166 0038 C095      		com r28
 167 003a D095      		com r29
 168               	.LVL7:
 169               	.L7:
 363:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 170               		.loc 1 363 43 is_stmt 1 discriminator 1 view .LVU32
 363:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 171               		.loc 1 363 5 is_stmt 0 discriminator 1 view .LVU33
 172 003c 0213      		cpse r16,r18
 173 003e 00C0      		rjmp .L14
 174               	.LVL8:
 175               	.L5:
 176               	/* epilogue start */
 363:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 177               		.loc 1 363 5 discriminator 1 view .LVU34
 178               	.LBE8:
 376:tmk_core/common/action_tapping.c **** 
 179               		.loc 1 376 1 view .LVU35
 180 0040 DF91      		pop r29
 181 0042 CF91      		pop r28
 182 0044 1F91      		pop r17
 183 0046 0F91      		pop r16
 184 0048 FF90      		pop r15
 185 004a 0895      		ret
 186               	.LVL9:
 187               	.L14:
 188               	.LBB11:
 364:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 189               		.loc 1 364 9 is_stmt 1 view .LVU36
 190               	.LBB9:
 191               	.LBI9:
 192               		.file 2 "tmk_core/common/keyboard.h"
   1:tmk_core/common/keyboard.h **** /*
   2:tmk_core/common/keyboard.h **** Copyright 2011,2012,2013 Jun Wako <wakojun@gmail.com>
   3:tmk_core/common/keyboard.h **** 
   4:tmk_core/common/keyboard.h **** This program is free software: you can redistribute it and/or modify
   5:tmk_core/common/keyboard.h **** it under the terms of the GNU General Public License as published by
   6:tmk_core/common/keyboard.h **** the Free Software Foundation, either version 2 of the License, or
   7:tmk_core/common/keyboard.h **** (at your option) any later version.
   8:tmk_core/common/keyboard.h **** 
   9:tmk_core/common/keyboard.h **** This program is distributed in the hope that it will be useful,
  10:tmk_core/common/keyboard.h **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:tmk_core/common/keyboard.h **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:tmk_core/common/keyboard.h **** GNU General Public License for more details.
  13:tmk_core/common/keyboard.h **** 
  14:tmk_core/common/keyboard.h **** You should have received a copy of the GNU General Public License
  15:tmk_core/common/keyboard.h **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:tmk_core/common/keyboard.h **** */
  17:tmk_core/common/keyboard.h **** 
  18:tmk_core/common/keyboard.h **** #ifndef KEYBOARD_H
  19:tmk_core/common/keyboard.h **** #define KEYBOARD_H
  20:tmk_core/common/keyboard.h **** 
  21:tmk_core/common/keyboard.h **** #include <stdbool.h>
  22:tmk_core/common/keyboard.h **** #include <stdint.h>
  23:tmk_core/common/keyboard.h **** 
  24:tmk_core/common/keyboard.h **** #ifdef __cplusplus
  25:tmk_core/common/keyboard.h **** extern "C" {
  26:tmk_core/common/keyboard.h **** #endif
  27:tmk_core/common/keyboard.h **** 
  28:tmk_core/common/keyboard.h **** /* key matrix position */
  29:tmk_core/common/keyboard.h **** typedef struct {
  30:tmk_core/common/keyboard.h ****     uint8_t col;
  31:tmk_core/common/keyboard.h ****     uint8_t row;
  32:tmk_core/common/keyboard.h **** } keypos_t;
  33:tmk_core/common/keyboard.h **** 
  34:tmk_core/common/keyboard.h **** /* key event */
  35:tmk_core/common/keyboard.h **** typedef struct {
  36:tmk_core/common/keyboard.h ****     keypos_t key;
  37:tmk_core/common/keyboard.h ****     bool     pressed;
  38:tmk_core/common/keyboard.h ****     uint16_t time;
  39:tmk_core/common/keyboard.h **** } keyevent_t;
  40:tmk_core/common/keyboard.h **** 
  41:tmk_core/common/keyboard.h **** /* equivalent test of keypos_t */
  42:tmk_core/common/keyboard.h **** #define KEYEQ(keya, keyb) ((keya).row == (keyb).row && (keya).col == (keyb).col)
  43:tmk_core/common/keyboard.h **** 
  44:tmk_core/common/keyboard.h **** /* Rules for No Event:
  45:tmk_core/common/keyboard.h ****  * 1) (time == 0) to handle (keyevent_t){} as empty event
  46:tmk_core/common/keyboard.h ****  * 2) Matrix(255, 255) to make TICK event available
  47:tmk_core/common/keyboard.h ****  */
  48:tmk_core/common/keyboard.h **** static inline bool IS_NOEVENT(keyevent_t event) { return event.time == 0 || (event.key.row == 255 &
 193               		.loc 2 48 20 view .LVU37
 194               	.LBB10:
 195               		.loc 2 48 51 view .LVU38
 196 004c 30E0      		ldi r19,0
 197               		.loc 2 48 74 is_stmt 0 view .LVU39
 198 004e 3097      		sbiw r30,0
 199 0050 01F0      		breq .L8
 200 0052 8FEF      		ldi r24,lo8(-1)
 201 0054 F812      		cpse r15,r24
 202 0056 00C0      		rjmp .L27
 203               	.L8:
 204               	.LBE10:
 205               	.LBE9:
 363:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 206               		.loc 1 363 69 is_stmt 1 discriminator 2 view .LVU40
 363:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 207               		.loc 1 363 76 is_stmt 0 discriminator 2 view .LVU41
 208 0058 2F5F      		subi r18,-1
 209 005a 3F4F      		sbci r19,-1
 210               	.LVL10:
 363:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 211               		.loc 1 363 71 discriminator 2 view .LVU42
 212 005c 2770      		andi r18,lo8(7)
 363:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 213               		.loc 1 363 71 discriminator 2 view .LVU43
 214 005e 00C0      		rjmp .L7
 215               	.LVL11:
 216               	.L10:
 364:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 217               		.loc 1 364 96 discriminator 6 view .LVU44
 218 0060 8C0F      		add r24,r28
 219 0062 9D1F      		adc r25,r29
 220 0064 00C0      		rjmp .L28
 221               	.L27:
 364:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 222               		.loc 1 364 13 view .LVU45
 223 0066 C901      		movw r24,r18
 224 0068 66E0      		ldi r22,lo8(6)
 225 006a 70E0      		ldi r23,0
 226 006c 0E94 0000 		call __mulhi3
 227 0070 DC01      		movw r26,r24
 228 0072 A050      		subi r26,lo8(-(waiting_buffer))
 229 0074 B040      		sbci r27,hi8(-(waiting_buffer))
 230 0076 1196      		adiw r26,1
 231 0078 8C91      		ld r24,X
 232 007a 1197      		sbiw r26,1
 233 007c 8113      		cpse r24,r17
 234 007e 00C0      		rjmp .L8
 364:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 235               		.loc 1 364 13 discriminator 2 view .LVU46
 236 0080 8C91      		ld r24,X
 237 0082 8413      		cpse r24,r20
 238 0084 00C0      		rjmp .L8
 364:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 239               		.loc 1 364 57 discriminator 3 view .LVU47
 240 0086 1296      		adiw r26,2
 241 0088 8C91      		ld r24,X
 242 008a 1297      		sbiw r26,2
 243 008c 8111      		cpse r24,__zero_reg__
 244 008e 00C0      		rjmp .L8
 364:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 245               		.loc 1 364 96 discriminator 4 view .LVU48
 246 0090 1396      		adiw r26,3
 247 0092 8D91      		ld r24,X+
 248 0094 9C91      		ld r25,X
 249 0096 8E17      		cp r24,r30
 250 0098 9F07      		cpc r25,r31
 251 009a 00F0      		brlo .L10
 364:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 252               		.loc 1 364 96 discriminator 5 view .LVU49
 253 009c 8E1B      		sub r24,r30
 254 009e 9F0B      		sbc r25,r31
 255               	.L28:
 364:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 256               		.loc 1 364 96 discriminator 6 view .LVU50
 257 00a0 883C      		cpi r24,-56
 258 00a2 9105      		cpc r25,__zero_reg__
 259 00a4 00F4      		brsh .L8
 365:tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 260               		.loc 1 365 13 is_stmt 1 view .LVU51
 365:tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 261               		.loc 1 365 41 is_stmt 0 view .LVU52
 262 00a6 8091 0000 		lds r24,tapping_key+5
 263 00aa 8F70      		andi r24,lo8(15)
 264 00ac 8061      		ori r24,lo8(16)
 265 00ae 8093 0000 		sts tapping_key+5,r24
 366:tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 266               		.loc 1 366 13 is_stmt 1 view .LVU53
 366:tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 267               		.loc 1 366 41 is_stmt 0 view .LVU54
 268 00b2 C901      		movw r24,r18
 269 00b4 66E0      		ldi r22,lo8(6)
 270 00b6 70E0      		ldi r23,0
 271 00b8 0E94 0000 		call __mulhi3
 272 00bc FC01      		movw r30,r24
 273 00be E050      		subi r30,lo8(-(waiting_buffer+5))
 274 00c0 F040      		sbci r31,hi8(-(waiting_buffer+5))
 275 00c2 9081      		ld r25,Z
 276 00c4 9F70      		andi r25,lo8(15)
 277 00c6 9061      		ori r25,lo8(16)
 278 00c8 9083      		st Z,r25
 367:tmk_core/common/action_tapping.c **** 
 279               		.loc 1 367 13 is_stmt 1 view .LVU55
 280 00ca 80E0      		ldi r24,lo8(tapping_key)
 281 00cc 90E0      		ldi r25,hi8(tapping_key)
 282 00ce 0E94 0000 		call process_record
 283               	.LVL12:
 369:tmk_core/common/action_tapping.c ****             debug_dec(i);
 284               		.loc 1 369 57 view .LVU56
 370:tmk_core/common/action_tapping.c ****             debug("]\n");
 285               		.loc 1 370 25 view .LVU57
 371:tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 286               		.loc 1 371 25 view .LVU58
 372:tmk_core/common/action_tapping.c ****             return;
 287               		.loc 1 372 13 view .LVU59
 288               	/* epilogue start */
 289               	.LBE11:
 376:tmk_core/common/action_tapping.c **** 
 290               		.loc 1 376 1 is_stmt 0 view .LVU60
 291 00d2 DF91      		pop r29
 292 00d4 CF91      		pop r28
 293 00d6 1F91      		pop r17
 294 00d8 0F91      		pop r16
 295 00da FF90      		pop r15
 296               	.LBB12:
 372:tmk_core/common/action_tapping.c ****             return;
 297               		.loc 1 372 13 view .LVU61
 298 00dc 0C94 0000 		jmp debug_waiting_buffer
 299               	.LVL13:
 300               	.LBE12:
 301               		.cfi_endproc
 302               	.LFE13:
 304               		.section	.text.process_tapping,"ax",@progbits
 306               	process_tapping:
 307               	.LVL14:
 308               	.LFB8:
  91:tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 309               		.loc 1 91 41 is_stmt 1 view -0
 310               		.cfi_startproc
  91:tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 311               		.loc 1 91 41 is_stmt 0 view .LVU63
 312 0000 BF92      		push r11
 313               	.LCFI7:
 314               		.cfi_def_cfa_offset 3
 315               		.cfi_offset 11, -2
 316 0002 CF92      		push r12
 317               	.LCFI8:
 318               		.cfi_def_cfa_offset 4
 319               		.cfi_offset 12, -3
 320 0004 DF92      		push r13
 321               	.LCFI9:
 322               		.cfi_def_cfa_offset 5
 323               		.cfi_offset 13, -4
 324 0006 EF92      		push r14
 325               	.LCFI10:
 326               		.cfi_def_cfa_offset 6
 327               		.cfi_offset 14, -5
 328 0008 FF92      		push r15
 329               	.LCFI11:
 330               		.cfi_def_cfa_offset 7
 331               		.cfi_offset 15, -6
 332 000a 0F93      		push r16
 333               	.LCFI12:
 334               		.cfi_def_cfa_offset 8
 335               		.cfi_offset 16, -7
 336 000c 1F93      		push r17
 337               	.LCFI13:
 338               		.cfi_def_cfa_offset 9
 339               		.cfi_offset 17, -8
 340 000e CF93      		push r28
 341               	.LCFI14:
 342               		.cfi_def_cfa_offset 10
 343               		.cfi_offset 28, -9
 344 0010 DF93      		push r29
 345               	.LCFI15:
 346               		.cfi_def_cfa_offset 11
 347               		.cfi_offset 29, -10
 348 0012 CDB7      		in r28,__SP_L__
 349 0014 DEB7      		in r29,__SP_H__
 350               	.LCFI16:
 351               		.cfi_def_cfa_register 28
 352 0016 6197      		sbiw r28,17
 353               	.LCFI17:
 354               		.cfi_def_cfa_offset 28
 355 0018 0FB6      		in __tmp_reg__,__SREG__
 356 001a F894      		cli
 357 001c DEBF      		out __SP_H__,r29
 358 001e 0FBE      		out __SREG__,__tmp_reg__
 359 0020 CDBF      		out __SP_L__,r28
 360               	/* prologue: function */
 361               	/* frame size = 17 */
 362               	/* stack size = 26 */
 363               	.L__stack_usage = 26
 364 0022 8C01      		movw r16,r24
  92:tmk_core/common/action_tapping.c **** 
 365               		.loc 1 92 5 is_stmt 1 view .LVU64
  92:tmk_core/common/action_tapping.c **** 
 366               		.loc 1 92 16 is_stmt 0 view .LVU65
 367 0024 85E0      		ldi r24,lo8(5)
 368               	.LVL15:
  92:tmk_core/common/action_tapping.c **** 
 369               		.loc 1 92 16 view .LVU66
 370 0026 F801      		movw r30,r16
 371 0028 DE01      		movw r26,r28
 372 002a 1D96      		adiw r26,13
 373               		0:
 374 002c 0190      		ld r0,Z+
 375 002e 0D92      		st X+,r0
 376 0030 8A95      		dec r24
 377 0032 01F4      		brne 0b
 378 0034 D801      		movw r26,r16
 379 0036 4C91      		ld r20,X
 380               	.LVL16:
  92:tmk_core/common/action_tapping.c **** 
 381               		.loc 1 92 16 view .LVU67
 382 0038 1196      		adiw r26,1
 383 003a 2C91      		ld r18,X
 384 003c 1197      		sbiw r26,1
 385               	.LVL17:
  92:tmk_core/common/action_tapping.c **** 
 386               		.loc 1 92 16 view .LVU68
 387 003e 1296      		adiw r26,2
 388 0040 EC90      		ld r14,X
 389 0042 1297      		sbiw r26,2
 390               	.LVL18:
  95:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 391               		.loc 1 95 5 is_stmt 1 view .LVU69
  95:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 392               		.loc 1 95 9 is_stmt 0 view .LVU70
 393 0044 8091 0000 		lds r24,tapping_key+3
 394 0048 9091 0000 		lds r25,tapping_key+3+1
 395               	.LBB23:
 396               	.LBI23:
 397               		.loc 2 48 20 is_stmt 1 view .LVU71
 398               	.LBB24:
 399               		.loc 2 48 51 view .LVU72
 400               		.loc 2 48 74 is_stmt 0 view .LVU73
 401 004c 0097      		sbiw r24,0
 402 004e 01F4      		brne .+2
 403 0050 00C0      		rjmp .L30
 404               	.LBE24:
 405               	.LBE23:
  95:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 406               		.loc 1 95 9 view .LVU74
 407 0052 3091 0000 		lds r19,tapping_key
 408 0056 5091 0000 		lds r21,tapping_key+1
 409               	.LBB26:
 410               	.LBB25:
 411               		.loc 2 48 74 view .LVU75
 412 005a 632F      		mov r22,r19
 413 005c 6523      		and r22,r21
 414 005e 6F3F      		cpi r22,lo8(-1)
 415 0060 01F4      		brne .+2
 416 0062 00C0      		rjmp .L30
 417               	.LBE25:
 418               	.LBE26:
  92:tmk_core/common/action_tapping.c **** 
 419               		.loc 1 92 16 discriminator 1 view .LVU76
 420 0064 1396      		adiw r26,3
 421 0066 CD90      		ld r12,X+
 422 0068 DC90      		ld r13,X
  95:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 423               		.loc 1 95 9 discriminator 1 view .LVU77
 424 006a B090 0000 		lds r11,tapping_key+2
 425 006e BB20      		tst r11
 426 0070 01F4      		brne .+2
 427 0072 00C0      		rjmp .L31
  96:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 428               		.loc 1 96 9 is_stmt 1 view .LVU78
  96:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 429               		.loc 1 96 13 is_stmt 0 view .LVU79
 430 0074 C816      		cp r12,r24
 431 0076 D906      		cpc r13,r25
 432 0078 00F0      		brlo .L32
  96:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 433               		.loc 1 96 13 discriminator 1 view .LVU80
 434 007a F601      		movw r30,r12
 435 007c E81B      		sub r30,r24
 436 007e F90B      		sbc r31,r25
 437 0080 CF01      		movw r24,r30
 438               	.L123:
  96:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 439               		.loc 1 96 13 discriminator 2 view .LVU81
 440 0082 FF24      		clr r15
 441 0084 F394      		inc r15
 442 0086 883C      		cpi r24,-56
 443 0088 9105      		cpc r25,__zero_reg__
 444 008a 00F0      		brlo .L34
 445 008c F12C      		mov r15,__zero_reg__
 446               	.L34:
 447 008e 8091 0000 		lds r24,tapping_key+5
 448 0092 982F      		mov r25,r24
 449 0094 907F      		andi r25,lo8(-16)
  96:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 450               		.loc 1 96 12 discriminator 4 view .LVU82
 451 0096 FF20      		tst r15
 452 0098 01F4      		brne .+2
 453 009a 00C0      		rjmp .L36
  97:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 454               		.loc 1 97 13 is_stmt 1 view .LVU83
  97:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 455               		.loc 1 97 16 is_stmt 0 view .LVU84
 456 009c 9111      		cpse r25,__zero_reg__
 457 009e 00C0      		rjmp .L37
  98:tmk_core/common/action_tapping.c ****                     // first tap!
 458               		.loc 1 98 17 is_stmt 1 discriminator 1 view .LVU85
 459 00a0 FE2C      		mov r15,r14
  98:tmk_core/common/action_tapping.c ****                     // first tap!
 460               		.loc 1 98 21 is_stmt 0 discriminator 1 view .LVU86
 461 00a2 5213      		cpse r21,r18
 462 00a4 00C0      		rjmp .L38
  98:tmk_core/common/action_tapping.c ****                     // first tap!
 463               		.loc 1 98 21 discriminator 2 view .LVU87
 464 00a6 3413      		cpse r19,r20
 465 00a8 00C0      		rjmp .L38
  98:tmk_core/common/action_tapping.c ****                     // first tap!
 466               		.loc 1 98 47 discriminator 3 view .LVU88
 467 00aa E110      		cpse r14,__zero_reg__
 468 00ac 00C0      		rjmp .L38
 100:tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 469               		.loc 1 100 57 is_stmt 1 view .LVU89
 101:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 470               		.loc 1 101 21 view .LVU90
 101:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 471               		.loc 1 101 43 is_stmt 0 view .LVU91
 472 00ae 8F70      		andi r24,lo8(15)
 473 00b0 8061      		ori r24,lo8(16)
 474 00b2 8093 0000 		sts tapping_key+5,r24
 475               	.LVL19:
 102:tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 476               		.loc 1 102 21 is_stmt 1 view .LVU92
 477 00b6 0E94 0000 		call debug_tapping_key
 478               	.LVL20:
 103:tmk_core/common/action_tapping.c **** 
 479               		.loc 1 103 21 view .LVU93
 480 00ba 80E0      		ldi r24,lo8(tapping_key)
 481 00bc 90E0      		ldi r25,hi8(tapping_key)
 482 00be 0E94 0000 		call process_record
 483               	.LVL21:
 106:tmk_core/common/action_tapping.c ****                     // enqueue
 484               		.loc 1 106 21 view .LVU94
 106:tmk_core/common/action_tapping.c ****                     // enqueue
 485               		.loc 1 106 31 is_stmt 0 view .LVU95
 486 00c2 8091 0000 		lds r24,tapping_key+5
 487 00c6 D801      		movw r26,r16
 488 00c8 1596      		adiw r26,5
 489 00ca 8C93      		st X,r24
 108:tmk_core/common/action_tapping.c ****                 }
 490               		.loc 1 108 21 is_stmt 1 view .LVU96
 491               	.LVL22:
 492               	.L29:
 296:tmk_core/common/action_tapping.c **** 
 493               		.loc 1 296 1 is_stmt 0 view .LVU97
 494 00cc 8F2D      		mov r24,r15
 495               	/* epilogue start */
 296:tmk_core/common/action_tapping.c **** 
 496               		.loc 1 296 1 view .LVU98
 497 00ce 6196      		adiw r28,17
 498 00d0 0FB6      		in __tmp_reg__,__SREG__
 499 00d2 F894      		cli
 500 00d4 DEBF      		out __SP_H__,r29
 501 00d6 0FBE      		out __SREG__,__tmp_reg__
 502 00d8 CDBF      		out __SP_L__,r28
 503 00da DF91      		pop r29
 504 00dc CF91      		pop r28
 505 00de 1F91      		pop r17
 506 00e0 0F91      		pop r16
 507               	.LVL23:
 296:tmk_core/common/action_tapping.c **** 
 508               		.loc 1 296 1 view .LVU99
 509 00e2 FF90      		pop r15
 510 00e4 EF90      		pop r14
 511               	.LVL24:
 296:tmk_core/common/action_tapping.c **** 
 512               		.loc 1 296 1 view .LVU100
 513 00e6 DF90      		pop r13
 514 00e8 CF90      		pop r12
 515 00ea BF90      		pop r11
 516 00ec 0895      		ret
 517               	.LVL25:
 518               	.L32:
  96:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 519               		.loc 1 96 13 discriminator 2 view .LVU101
 520 00ee 8095      		com r24
 521 00f0 9095      		com r25
 522 00f2 8C0D      		add r24,r12
 523 00f4 9D1D      		adc r25,r13
 524 00f6 00C0      		rjmp .L123
 525               	.L38:
 133:tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 526               		.loc 1 133 22 is_stmt 1 view .LVU102
 527               	.LVL26:
 528               	.LBB27:
 529               	.LBI27:
  49:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
  50:tmk_core/common/keyboard.h **** static inline bool IS_RELEASED(keyevent_t event) { return (!IS_NOEVENT(event) && !event.pressed); }
 530               		.loc 2 50 20 view .LVU103
 531               	.LBB28:
 532               		.loc 2 50 52 view .LVU104
 533               	.LBB29:
 534               	.LBI29:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 535               		.loc 2 48 20 view .LVU105
 536               	.LBB30:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 537               		.loc 2 48 51 view .LVU106
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 538               		.loc 2 48 74 is_stmt 0 view .LVU107
 539 00f8 CD28      		or r12,r13
 540 00fa 01F0      		breq .L69
 541 00fc 822F      		mov r24,r18
 542 00fe 8423      		and r24,r20
 543 0100 8F3F      		cpi r24,lo8(-1)
 544 0102 01F0      		breq .+2
 545 0104 00C0      		rjmp .L41
 546               	.L69:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 547               		.loc 2 48 74 view .LVU108
 548               	.LBE30:
 549               	.LBE29:
 550               		.loc 2 50 79 view .LVU109
 551 0106 80E0      		ldi r24,0
 552               	.L40:
 553               	.LVL27:
 554               		.loc 2 50 79 view .LVU110
 555               	.LBE28:
 556               	.LBE27:
 133:tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 557               		.loc 1 133 25 view .LVU111
 558 0108 B82F      		mov r27,r24
 559 010a B170      		andi r27,lo8(1)
 560 010c DB2E      		mov r13,r27
 561               	.LBB32:
 562               	.LBB33:
 334:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 563               		.loc 1 334 18 view .LVU112
 564 010e E091 0000 		lds r30,waiting_buffer_tail
 565               	.LVL28:
 334:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 566               		.loc 1 334 45 view .LVU113
 567 0112 3091 0000 		lds r19,waiting_buffer_head
 568               	.LBE33:
 569               	.LBE32:
 133:tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 570               		.loc 1 133 25 view .LVU114
 571 0116 80FD      		sbrc r24,0
 572 0118 00C0      		rjmp .L43
 573               	.L42:
 154:tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 574               		.loc 1 154 21 is_stmt 1 view .LVU115
 154:tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 575               		.loc 1 154 24 is_stmt 0 view .LVU116
 576 011a EE20      		tst r14
 577 011c 01F0      		breq .L29
 155:tmk_core/common/action_tapping.c ****                     }
 578               		.loc 1 155 25 is_stmt 1 view .LVU117
 155:tmk_core/common/action_tapping.c ****                     }
 579               		.loc 1 155 53 is_stmt 0 view .LVU118
 580 011e 8091 0000 		lds r24,tapping_key+5
 581 0122 8160      		ori r24,lo8(1<<0)
 582 0124 8093 0000 		sts tapping_key+5,r24
 158:tmk_core/common/action_tapping.c ****                 }
 583               		.loc 1 158 28 view .LVU119
 584 0128 F12C      		mov r15,__zero_reg__
 585 012a 00C0      		rjmp .L29
 586               	.L45:
 587               	.LBB35:
 588               	.LBB34:
 335:tmk_core/common/action_tapping.c ****             return true;
 589               		.loc 1 335 9 is_stmt 1 view .LVU120
 335:tmk_core/common/action_tapping.c ****             return true;
 590               		.loc 1 335 13 is_stmt 0 view .LVU121
 591 012c F0E0      		ldi r31,0
 592 012e CF01      		movw r24,r30
 593 0130 66E0      		ldi r22,lo8(6)
 594 0132 70E0      		ldi r23,0
 595 0134 0E94 0000 		call __mulhi3
 596 0138 DC01      		movw r26,r24
 597 013a A050      		subi r26,lo8(-(waiting_buffer))
 598 013c B040      		sbci r27,hi8(-(waiting_buffer))
 335:tmk_core/common/action_tapping.c ****             return true;
 599               		.loc 1 335 12 view .LVU122
 600 013e 1196      		adiw r26,1
 601 0140 8C91      		ld r24,X
 602 0142 1197      		sbiw r26,1
 603 0144 8213      		cpse r24,r18
 604 0146 00C0      		rjmp .L44
 335:tmk_core/common/action_tapping.c ****             return true;
 605               		.loc 1 335 13 view .LVU123
 606 0148 8C91      		ld r24,X
 607 014a 8413      		cpse r24,r20
 608 014c 00C0      		rjmp .L44
 335:tmk_core/common/action_tapping.c ****             return true;
 609               		.loc 1 335 59 view .LVU124
 610 014e 1296      		adiw r26,2
 611 0150 8C91      		ld r24,X
 612 0152 E812      		cpse r14,r24
 613 0154 00C0      		rjmp .L42
 614               	.L44:
 334:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 615               		.loc 1 334 69 is_stmt 1 view .LVU125
 334:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 616               		.loc 1 334 76 is_stmt 0 view .LVU126
 617 0156 3196      		adiw r30,1
 618               	.LVL29:
 334:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 619               		.loc 1 334 71 view .LVU127
 620 0158 E770      		andi r30,lo8(7)
 621               	.L43:
 622               	.LVL30:
 334:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 623               		.loc 1 334 43 is_stmt 1 view .LVU128
 334:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 624               		.loc 1 334 5 is_stmt 0 view .LVU129
 625 015a E313      		cpse r30,r19
 626 015c 00C0      		rjmp .L45
 627               	.LVL31:
 334:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 628               		.loc 1 334 5 view .LVU130
 629               	.LBE34:
 630               	.LBE35:
 631               	.LBB36:
 135:tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 632               		.loc 1 135 21 is_stmt 1 view .LVU131
 135:tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 633               		.loc 1 135 39 is_stmt 0 view .LVU132
 634 015e 4D87      		std Y+13,r20
 635 0160 2E87      		std Y+14,r18
 636 0162 8D85      		ldd r24,Y+13
 637 0164 9E85      		ldd r25,Y+14
 638 0166 0E94 0000 		call layer_switch_get_action
 639               	.LVL32:
 136:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 640               		.loc 1 136 21 is_stmt 1 view .LVU133
 136:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 641               		.loc 1 136 40 is_stmt 0 view .LVU134
 642 016a 292F      		mov r18,r25
 643 016c 2295      		swap r18
 644 016e 2F70      		andi r18,lo8(15)
 136:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 645               		.loc 1 136 21 view .LVU135
 646 0170 2230      		cpi r18,lo8(2)
 647 0172 00F0      		brlo .L67
 136:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 648               		.loc 1 136 21 view .LVU136
 649 0174 2430      		cpi r18,lo8(4)
 650 0176 00F4      		brsh .L49
 144:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 651               		.loc 1 144 29 is_stmt 1 view .LVU137
 144:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 652               		.loc 1 144 33 is_stmt 0 view .LVU138
 653 0178 9F70      		andi r25,lo8(15)
 654               	.LVL33:
 144:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 655               		.loc 1 144 32 view .LVU139
 656 017a 01F0      		breq .L50
 144:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 657               		.loc 1 144 68 discriminator 1 view .LVU140
 658 017c F801      		movw r30,r16
 659 017e 9581      		ldd r25,Z+5
 660 0180 907F      		andi r25,lo8(-16)
 144:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 661               		.loc 1 144 49 discriminator 1 view .LVU141
 662 0182 01F4      		brne .L50
 663               	.LVL34:
 664               	.L73:
 139:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 665               		.loc 1 139 77 view .LVU142
 666 0184 D12C      		mov r13,__zero_reg__
 667 0186 00C0      		rjmp .L48
 668               	.LVL35:
 669               	.L67:
 139:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 670               		.loc 1 139 29 is_stmt 1 view .LVU143
 139:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 671               		.loc 1 139 33 is_stmt 0 view .LVU144
 672 0188 9F70      		andi r25,lo8(15)
 673               	.LVL36:
 139:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 674               		.loc 1 139 32 view .LVU145
 675 018a 01F0      		breq .L50
 139:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 676               		.loc 1 139 49 discriminator 1 view .LVU146
 677 018c 8823      		tst r24
 678 018e 01F0      		breq .L73
 679               	.L50:
 145:tmk_core/common/action_tapping.c ****                             break;
 680               		.loc 1 145 29 is_stmt 1 view .LVU147
 145:tmk_core/common/action_tapping.c ****                             break;
 681               		.loc 1 145 33 is_stmt 0 view .LVU148
 682 0190 805E      		subi r24,lo8(-(32))
 683               	.LVL37:
 145:tmk_core/common/action_tapping.c ****                             break;
 684               		.loc 1 145 32 view .LVU149
 685 0192 8830      		cpi r24,lo8(8)
 686 0194 00F0      		brlo .L73
 687               	.LVL38:
 688               	.L49:
 149:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 689               		.loc 1 149 86 is_stmt 1 view .LVU150
 150:tmk_core/common/action_tapping.c ****                     return true;
 690               		.loc 1 150 21 view .LVU151
 691 0196 C801      		movw r24,r16
 692               	.LVL39:
 150:tmk_core/common/action_tapping.c ****                     return true;
 693               		.loc 1 150 21 is_stmt 0 view .LVU152
 694 0198 0E94 0000 		call process_record
 695               	.LVL40:
 151:tmk_core/common/action_tapping.c ****                 } else {
 696               		.loc 1 151 21 is_stmt 1 view .LVU153
 697               	.L48:
 151:tmk_core/common/action_tapping.c ****                 } else {
 698               		.loc 1 151 21 is_stmt 0 view .LVU154
 699 019c FD2C      		mov r15,r13
 700 019e 00C0      		rjmp .L29
 701               	.LVL41:
 702               	.L37:
 151:tmk_core/common/action_tapping.c ****                 } else {
 703               		.loc 1 151 21 view .LVU155
 704               	.LBE36:
 163:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 705               		.loc 1 163 17 is_stmt 1 discriminator 1 view .LVU156
 163:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 706               		.loc 1 163 21 is_stmt 0 discriminator 1 view .LVU157
 707 01a0 5213      		cpse r21,r18
 708 01a2 00C0      		rjmp .L51
 163:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 709               		.loc 1 163 21 discriminator 2 view .LVU158
 710 01a4 3413      		cpse r19,r20
 711 01a6 00C0      		rjmp .L51
 167:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 712               		.loc 1 167 31 discriminator 3 view .LVU159
 713 01a8 D801      		movw r26,r16
 163:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 714               		.loc 1 163 47 discriminator 3 view .LVU160
 715 01aa EE20      		tst r14
 716 01ac 01F4      		brne .+2
 717 01ae 00C0      		rjmp .L130
 718               	.L51:
 172:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 719               		.loc 1 172 24 is_stmt 1 view .LVU161
 172:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 720               		.loc 1 172 28 is_stmt 0 view .LVU162
 721 01b0 4D87      		std Y+13,r20
 722 01b2 2E87      		std Y+14,r18
 723 01b4 8D85      		ldd r24,Y+13
 724 01b6 9E85      		ldd r25,Y+14
 725 01b8 0E94 0000 		call is_tap_key
 726               	.LVL42:
 172:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 727               		.loc 1 172 27 view .LVU163
 728 01bc 8823      		tst r24
 729 01be 01F0      		breq .L63
 172:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 730               		.loc 1 172 50 discriminator 1 view .LVU164
 731 01c0 EE20      		tst r14
 732 01c2 01F0      		breq .L63
 173:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 733               		.loc 1 173 21 is_stmt 1 view .LVU165
 173:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 734               		.loc 1 173 40 is_stmt 0 view .LVU166
 735 01c4 8091 0000 		lds r24,tapping_key+5
 173:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 736               		.loc 1 173 24 view .LVU167
 737 01c8 8032      		cpi r24,lo8(32)
 738 01ca 00F0      		brlo .L54
 174:tmk_core/common/action_tapping.c ****                         // unregister key
 739               		.loc 1 174 87 is_stmt 1 view .LVU168
 176:tmk_core/common/action_tapping.c ****                     } else {
 740               		.loc 1 176 25 view .LVU169
 176:tmk_core/common/action_tapping.c ****                     } else {
 741               		.loc 1 176 54 is_stmt 0 view .LVU170
 742 01cc 2091 0000 		lds r18,tapping_key
 743 01d0 3091 0000 		lds r19,tapping_key+1
 744 01d4 3887      		std Y+8,r19
 745 01d6 2F83      		std Y+7,r18
 746 01d8 1986      		std Y+9,__zero_reg__
 747 01da DB86      		std Y+11,r13
 748 01dc CA86      		std Y+10,r12
 749 01de 8C87      		std Y+12,r24
 176:tmk_core/common/action_tapping.c ****                     } else {
 750               		.loc 1 176 25 view .LVU171
 751 01e0 CE01      		movw r24,r28
 752 01e2 0796      		adiw r24,7
 753               	.L124:
 176:tmk_core/common/action_tapping.c ****                     } else {
 754               		.loc 1 176 25 view .LVU172
 755 01e4 0E94 0000 		call process_record
 756               	.LVL43:
 757               	.L54:
 178:tmk_core/common/action_tapping.c ****                     }
 758               		.loc 1 178 69 is_stmt 1 view .LVU173
 180:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 759               		.loc 1 180 21 view .LVU174
 180:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 760               		.loc 1 180 33 is_stmt 0 view .LVU175
 761 01e8 86E0      		ldi r24,lo8(6)
 762 01ea F801      		movw r30,r16
 763 01ec A0E0      		ldi r26,lo8(tapping_key)
 764 01ee B0E0      		ldi r27,hi8(tapping_key)
 765               		0:
 766 01f0 0190      		ld r0,Z+
 767 01f2 0D92      		st X+,r0
 768 01f4 8A95      		dec r24
 769 01f6 01F4      		brne 0b
 181:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 770               		.loc 1 181 21 is_stmt 1 view .LVU176
 771 01f8 0E94 0000 		call waiting_buffer_scan_tap
 772               	.LVL44:
 182:tmk_core/common/action_tapping.c ****                     return true;
 773               		.loc 1 182 21 view .LVU177
 774 01fc 0E94 0000 		call debug_tapping_key
 775               	.LVL45:
 183:tmk_core/common/action_tapping.c ****                 } else {
 776               		.loc 1 183 21 view .LVU178
 777               	.L127:
 189:tmk_core/common/action_tapping.c ****                 }
 778               		.loc 1 189 21 view .LVU179
 189:tmk_core/common/action_tapping.c ****                 }
 779               		.loc 1 189 28 is_stmt 0 view .LVU180
 780 0200 FF24      		clr r15
 781 0202 F394      		inc r15
 782 0204 00C0      		rjmp .L29
 783               	.L63:
 185:tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 784               		.loc 1 185 21 is_stmt 1 view .LVU181
 186:tmk_core/common/action_tapping.c ****                     }
 785               		.loc 1 186 74 view .LVU182
 188:tmk_core/common/action_tapping.c ****                     return true;
 786               		.loc 1 188 21 view .LVU183
 787 0206 C801      		movw r24,r16
 788 0208 0E94 0000 		call process_record
 789               	.LVL46:
 790 020c 00C0      		rjmp .L127
 791               	.LVL47:
 792               	.L36:
 195:tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 793               		.loc 1 195 13 view .LVU184
 195:tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 794               		.loc 1 195 16 is_stmt 0 view .LVU185
 795 020e 9111      		cpse r25,__zero_reg__
 796 0210 00C0      		rjmp .L55
 196:tmk_core/common/action_tapping.c ****                 debug_event(event);
 797               		.loc 1 196 61 is_stmt 1 view .LVU186
 197:tmk_core/common/action_tapping.c ****                 debug("\n");
 798               		.loc 1 197 17 view .LVU187
 197:tmk_core/common/action_tapping.c ****                 debug("\n");
 799               		.loc 1 197 17 is_stmt 0 view .LVU188
 800 0212 7C2D      		mov r23,r12
 801 0214 D98A      		std Y+17,r13
 802 0216 C88A      		std Y+16,r12
 803 0218 522F      		mov r21,r18
 804 021a 6E2D      		mov r22,r14
 805 021c 8989      		ldd r24,Y+17
 806 021e 0E94 0000 		call debug_event
 807               	.LVL48:
 198:tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 808               		.loc 1 198 28 is_stmt 1 view .LVU189
 199:tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 809               		.loc 1 199 17 view .LVU190
 810 0222 80E0      		ldi r24,lo8(tapping_key)
 811 0224 90E0      		ldi r25,hi8(tapping_key)
 812 0226 0E94 0000 		call process_record
 813               	.LVL49:
 200:tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 814               		.loc 1 200 17 view .LVU191
 815               	.L131:
 276:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 816               		.loc 1 276 24 view .LVU192
 277:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 817               		.loc 1 277 13 view .LVU193
 277:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 818               		.loc 1 277 25 is_stmt 0 view .LVU194
 819 022a 86E0      		ldi r24,lo8(6)
 820 022c E0E0      		ldi r30,lo8(tapping_key)
 821 022e F0E0      		ldi r31,hi8(tapping_key)
 822 0230 DF01      		movw r26,r30
 823               		0:
 824 0232 1D92      		st X+,__zero_reg__
 825 0234 8A95      		dec r24
 826 0236 01F4      		brne 0b
 278:tmk_core/common/action_tapping.c ****             return false;
 827               		.loc 1 278 13 is_stmt 1 view .LVU195
 828 0238 00C0      		rjmp .L126
 829               	.LVL50:
 830               	.L55:
 204:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 831               		.loc 1 204 17 discriminator 1 view .LVU196
 204:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 832               		.loc 1 204 21 is_stmt 0 discriminator 1 view .LVU197
 833 023a 5213      		cpse r21,r18
 834 023c 00C0      		rjmp .L56
 204:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 835               		.loc 1 204 21 discriminator 2 view .LVU198
 836 023e 3413      		cpse r19,r20
 837 0240 00C0      		rjmp .L56
 204:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 838               		.loc 1 204 47 discriminator 3 view .LVU199
 839 0242 E110      		cpse r14,__zero_reg__
 840 0244 00C0      		rjmp .L56
 205:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 841               		.loc 1 205 73 is_stmt 1 view .LVU200
 206:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 842               		.loc 1 206 21 view .LVU201
 206:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 843               		.loc 1 206 31 is_stmt 0 view .LVU202
 844 0246 F801      		movw r30,r16
 845 0248 8583      		std Z+5,r24
 207:tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 846               		.loc 1 207 21 is_stmt 1 view .LVU203
 847 024a C801      		movw r24,r16
 848 024c 0E94 0000 		call process_record
 849               	.LVL51:
 208:tmk_core/common/action_tapping.c ****                     return true;
 850               		.loc 1 208 21 view .LVU204
 208:tmk_core/common/action_tapping.c ****                     return true;
 851               		.loc 1 208 33 is_stmt 0 view .LVU205
 852 0250 E0E0      		ldi r30,lo8(tapping_key)
 853 0252 F0E0      		ldi r31,hi8(tapping_key)
 854 0254 86E0      		ldi r24,lo8(6)
 855 0256 DF01      		movw r26,r30
 856               		0:
 857 0258 1D92      		st X+,__zero_reg__
 858 025a 8A95      		dec r24
 859 025c 01F4      		brne 0b
 209:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key) && event.pressed) {
 860               		.loc 1 209 21 is_stmt 1 view .LVU206
 209:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key) && event.pressed) {
 861               		.loc 1 209 28 is_stmt 0 view .LVU207
 862 025e FB2C      		mov r15,r11
 863 0260 00C0      		rjmp .L29
 864               	.LVL52:
 865               	.L56:
 210:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 866               		.loc 1 210 24 is_stmt 1 view .LVU208
 210:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 867               		.loc 1 210 28 is_stmt 0 view .LVU209
 868 0262 4D87      		std Y+13,r20
 869 0264 2E87      		std Y+14,r18
 870 0266 8D85      		ldd r24,Y+13
 871 0268 9E85      		ldd r25,Y+14
 872 026a 0E94 0000 		call is_tap_key
 873               	.LVL53:
 210:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 874               		.loc 1 210 27 view .LVU210
 875 026e 8823      		tst r24
 876 0270 01F0      		breq .L63
 210:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 877               		.loc 1 210 50 discriminator 1 view .LVU211
 878 0272 EE20      		tst r14
 879 0274 01F0      		breq .L63
 211:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 880               		.loc 1 211 21 is_stmt 1 view .LVU212
 211:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 881               		.loc 1 211 40 is_stmt 0 view .LVU213
 882 0276 8091 0000 		lds r24,tapping_key+5
 211:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 883               		.loc 1 211 24 view .LVU214
 884 027a 8032      		cpi r24,lo8(32)
 885 027c 00F4      		brsh .+2
 886 027e 00C0      		rjmp .L54
 212:tmk_core/common/action_tapping.c ****                         // unregister key
 887               		.loc 1 212 95 is_stmt 1 view .LVU215
 214:tmk_core/common/action_tapping.c ****                     } else {
 888               		.loc 1 214 25 view .LVU216
 214:tmk_core/common/action_tapping.c ****                     } else {
 889               		.loc 1 214 54 is_stmt 0 view .LVU217
 890 0280 2091 0000 		lds r18,tapping_key
 891 0284 3091 0000 		lds r19,tapping_key+1
 892 0288 3A83      		std Y+2,r19
 893 028a 2983      		std Y+1,r18
 894 028c 1B82      		std Y+3,__zero_reg__
 895 028e DD82      		std Y+5,r13
 896 0290 CC82      		std Y+4,r12
 897 0292 8E83      		std Y+6,r24
 214:tmk_core/common/action_tapping.c ****                     } else {
 898               		.loc 1 214 25 view .LVU218
 899 0294 CE01      		movw r24,r28
 900 0296 0196      		adiw r24,1
 901 0298 00C0      		rjmp .L124
 902               	.LVL54:
 903               	.L31:
 231:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 904               		.loc 1 231 12 is_stmt 1 discriminator 1 view .LVU219
 232:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 905               		.loc 1 232 9 discriminator 1 view .LVU220
 232:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 906               		.loc 1 232 13 is_stmt 0 discriminator 1 view .LVU221
 907 029a C816      		cp r12,r24
 908 029c D906      		cpc r13,r25
 909 029e 00F0      		brlo .L58
 910 02a0 F601      		movw r30,r12
 911 02a2 E81B      		sub r30,r24
 912 02a4 F90B      		sbc r31,r25
 913 02a6 CF01      		movw r24,r30
 914               	.L129:
 232:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 915               		.loc 1 232 13 discriminator 2 view .LVU222
 916 02a8 F12C      		mov r15,__zero_reg__
 917 02aa 883C      		cpi r24,-56
 918 02ac 9105      		cpc r25,__zero_reg__
 919 02ae 00F0      		brlo .+2
 920 02b0 00C0      		rjmp .L62
 233:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 921               		.loc 1 233 13 is_stmt 1 view .LVU223
 233:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 922               		.loc 1 233 22 is_stmt 0 view .LVU224
 923 02b2 FE2C      		mov r15,r14
 233:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 924               		.loc 1 233 16 view .LVU225
 925 02b4 EE20      		tst r14
 926 02b6 01F4      		brne .+2
 927 02b8 00C0      		rjmp .L63
 234:tmk_core/common/action_tapping.c **** #    ifndef TAPPING_FORCE_HOLD
 928               		.loc 1 234 17 is_stmt 1 discriminator 1 view .LVU226
 234:tmk_core/common/action_tapping.c **** #    ifndef TAPPING_FORCE_HOLD
 929               		.loc 1 234 21 is_stmt 0 discriminator 1 view .LVU227
 930 02ba 5213      		cpse r21,r18
 931 02bc 00C0      		rjmp .L64
 234:tmk_core/common/action_tapping.c **** #    ifndef TAPPING_FORCE_HOLD
 932               		.loc 1 234 21 discriminator 2 view .LVU228
 933 02be 3413      		cpse r19,r20
 934 02c0 00C0      		rjmp .L64
 236:tmk_core/common/action_tapping.c ****                         // sequential tap.
 935               		.loc 1 236 21 is_stmt 1 view .LVU229
 236:tmk_core/common/action_tapping.c ****                         // sequential tap.
 936               		.loc 1 236 41 is_stmt 0 view .LVU230
 937 02c2 8091 0000 		lds r24,tapping_key+5
 236:tmk_core/common/action_tapping.c ****                         // sequential tap.
 938               		.loc 1 236 24 view .LVU231
 939 02c6 80FD      		sbrc r24,0
 940 02c8 00C0      		rjmp .L65
 236:tmk_core/common/action_tapping.c ****                         // sequential tap.
 941               		.loc 1 236 79 discriminator 1 view .LVU232
 942 02ca 982F      		mov r25,r24
 943 02cc 907F      		andi r25,lo8(-16)
 236:tmk_core/common/action_tapping.c ****                         // sequential tap.
 944               		.loc 1 236 54 discriminator 1 view .LVU233
 945 02ce 01F0      		breq .L65
 238:tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 946               		.loc 1 238 25 is_stmt 1 view .LVU234
 238:tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 947               		.loc 1 238 35 is_stmt 0 view .LVU235
 948 02d0 D801      		movw r26,r16
 949 02d2 1596      		adiw r26,5
 950 02d4 8C93      		st X,r24
 951 02d6 1597      		sbiw r26,5
 239:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 952               		.loc 1 239 25 is_stmt 1 view .LVU236
 239:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 953               		.loc 1 239 28 is_stmt 0 view .LVU237
 954 02d8 903F      		cpi r25,lo8(-16)
 955 02da 01F0      		breq .L66
 239:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 956               		.loc 1 239 51 is_stmt 1 discriminator 1 view .LVU238
 239:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 957               		.loc 1 239 67 is_stmt 0 discriminator 1 view .LVU239
 958 02dc 982F      		mov r25,r24
 959 02de 907F      		andi r25,lo8(-16)
 960 02e0 905F      		subi r25,lo8(-(16))
 961 02e2 8F70      		andi r24,lo8(15)
 962 02e4 892B      		or r24,r25
 963               	.L130:
 239:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 964               		.loc 1 239 67 discriminator 1 view .LVU240
 965 02e6 1596      		adiw r26,5
 966 02e8 8C93      		st X,r24
 967               	.L66:
 240:tmk_core/common/action_tapping.c ****                         debug_dec(keyp->tap.count);
 968               		.loc 1 240 53 is_stmt 1 view .LVU241
 241:tmk_core/common/action_tapping.c ****                         debug(")\n");
 969               		.loc 1 241 51 view .LVU242
 242:tmk_core/common/action_tapping.c ****                         process_record(keyp);
 970               		.loc 1 242 37 view .LVU243
 243:tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 971               		.loc 1 243 25 view .LVU244
 972 02ea C801      		movw r24,r16
 973 02ec 0E94 0000 		call process_record
 974               	.LVL55:
 244:tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 975               		.loc 1 244 25 view .LVU245
 244:tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 976               		.loc 1 244 37 is_stmt 0 view .LVU246
 977 02f0 86E0      		ldi r24,lo8(6)
 978 02f2 F801      		movw r30,r16
 979 02f4 A0E0      		ldi r26,lo8(tapping_key)
 980 02f6 B0E0      		ldi r27,hi8(tapping_key)
 981               		0:
 982 02f8 0190      		ld r0,Z+
 983 02fa 0D92      		st X+,r0
 984 02fc 8A95      		dec r24
 985 02fe 01F4      		brne 0b
 245:tmk_core/common/action_tapping.c ****                         return true;
 986               		.loc 1 245 25 is_stmt 1 view .LVU247
 987               	.LVL56:
 988               	.L126:
 289:tmk_core/common/action_tapping.c ****             return true;
 989               		.loc 1 289 13 view .LVU248
 990 0300 0E94 0000 		call debug_tapping_key
 991               	.LVL57:
 290:tmk_core/common/action_tapping.c ****         } else {
 992               		.loc 1 290 13 view .LVU249
 290:tmk_core/common/action_tapping.c ****         } else {
 993               		.loc 1 290 20 is_stmt 0 view .LVU250
 994 0304 00C0      		rjmp .L29
 995               	.LVL58:
 996               	.L58:
 232:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 997               		.loc 1 232 13 discriminator 2 view .LVU251
 998 0306 8095      		com r24
 999 0308 9095      		com r25
 1000 030a 8C0D      		add r24,r12
 1001 030c 9D1D      		adc r25,r13
 1002 030e 00C0      		rjmp .L129
 1003               	.L65:
 250:tmk_core/common/action_tapping.c ****                     return true;
 1004               		.loc 1 250 21 is_stmt 1 view .LVU252
 250:tmk_core/common/action_tapping.c ****                     return true;
 1005               		.loc 1 250 33 is_stmt 0 view .LVU253
 1006 0310 86E0      		ldi r24,lo8(6)
 1007 0312 F801      		movw r30,r16
 1008 0314 A0E0      		ldi r26,lo8(tapping_key)
 1009 0316 B0E0      		ldi r27,hi8(tapping_key)
 1010               		0:
 1011 0318 0190      		ld r0,Z+
 1012 031a 0D92      		st X+,r0
 1013 031c 8A95      		dec r24
 1014 031e 01F4      		brne 0b
 251:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 1015               		.loc 1 251 21 is_stmt 1 view .LVU254
 251:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 1016               		.loc 1 251 28 is_stmt 0 view .LVU255
 1017 0320 00C0      		rjmp .L29
 1018               	.L64:
 252:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1019               		.loc 1 252 24 is_stmt 1 view .LVU256
 252:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1020               		.loc 1 252 28 is_stmt 0 view .LVU257
 1021 0322 4D87      		std Y+13,r20
 1022 0324 2E87      		std Y+14,r18
 1023 0326 8D85      		ldd r24,Y+13
 1024 0328 9E85      		ldd r25,Y+14
 1025 032a 0E94 0000 		call is_tap_key
 1026               	.LVL59:
 252:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1027               		.loc 1 252 27 view .LVU258
 1028 032e 8111      		cpse r24,__zero_reg__
 1029 0330 00C0      		rjmp .L54
 262:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 1030               		.loc 1 262 21 is_stmt 1 view .LVU259
 262:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 1031               		.loc 1 262 49 is_stmt 0 view .LVU260
 1032 0332 8091 0000 		lds r24,tapping_key+5
 1033 0336 8160      		ori r24,lo8(1<<0)
 1034 0338 8093 0000 		sts tapping_key+5,r24
 263:tmk_core/common/action_tapping.c ****                     return true;
 1035               		.loc 1 263 21 is_stmt 1 view .LVU261
 1036 033c C801      		movw r24,r16
 1037 033e 0E94 0000 		call process_record
 1038               	.LVL60:
 264:tmk_core/common/action_tapping.c ****                 }
 1039               		.loc 1 264 21 view .LVU262
 264:tmk_core/common/action_tapping.c ****                 }
 1040               		.loc 1 264 28 is_stmt 0 view .LVU263
 1041 0342 00C0      		rjmp .L29
 1042               	.LVL61:
 1043               	.L62:
 274:tmk_core/common/action_tapping.c ****             debug_event(event);
 1044               		.loc 1 274 70 is_stmt 1 view .LVU264
 275:tmk_core/common/action_tapping.c ****             debug("\n");
 1045               		.loc 1 275 13 view .LVU265
 275:tmk_core/common/action_tapping.c ****             debug("\n");
 1046               		.loc 1 275 13 is_stmt 0 view .LVU266
 1047 0344 7C2D      		mov r23,r12
 1048 0346 D98A      		std Y+17,r13
 1049 0348 C88A      		std Y+16,r12
 1050 034a 522F      		mov r21,r18
 1051 034c 6E2D      		mov r22,r14
 1052 034e 8989      		ldd r24,Y+17
 1053 0350 0E94 0000 		call debug_event
 1054               	.LVL62:
 275:tmk_core/common/action_tapping.c ****             debug("\n");
 1055               		.loc 1 275 13 view .LVU267
 1056 0354 00C0      		rjmp .L131
 1057               	.LVL63:
 1058               	.L30:
 284:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1059               		.loc 1 284 9 is_stmt 1 view .LVU268
 284:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1060               		.loc 1 284 12 is_stmt 0 view .LVU269
 1061 0356 EE20      		tst r14
 1062 0358 01F4      		brne .+2
 1063 035a 00C0      		rjmp .L63
 284:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1064               		.loc 1 284 30 discriminator 1 view .LVU270
 1065 035c 4D87      		std Y+13,r20
 1066 035e 2E87      		std Y+14,r18
 1067 0360 8D85      		ldd r24,Y+13
 1068 0362 9E85      		ldd r25,Y+14
 1069 0364 0E94 0000 		call is_tap_key
 1070               	.LVL64:
 284:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1071               		.loc 1 284 30 discriminator 1 view .LVU271
 1072 0368 F82E      		mov r15,r24
 284:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1073               		.loc 1 284 27 discriminator 1 view .LVU272
 1074 036a 8823      		tst r24
 1075 036c 01F4      		brne .+2
 1076 036e 00C0      		rjmp .L63
 285:tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 1077               		.loc 1 285 54 is_stmt 1 view .LVU273
 286:tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 1078               		.loc 1 286 13 view .LVU274
 286:tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 1079               		.loc 1 286 25 is_stmt 0 view .LVU275
 1080 0370 86E0      		ldi r24,lo8(6)
 1081 0372 F801      		movw r30,r16
 1082 0374 A0E0      		ldi r26,lo8(tapping_key)
 1083 0376 B0E0      		ldi r27,hi8(tapping_key)
 1084               		0:
 1085 0378 0190      		ld r0,Z+
 1086 037a 0D92      		st X+,r0
 1087 037c 8A95      		dec r24
 1088 037e 01F4      		brne 0b
 287:tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 1089               		.loc 1 287 13 is_stmt 1 view .LVU276
 1090 0380 80E0      		ldi r24,lo8(tapping_key)
 1091 0382 90E0      		ldi r25,hi8(tapping_key)
 1092 0384 0E94 0000 		call process_record_tap_hint
 1093               	.LVL65:
 288:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1094               		.loc 1 288 13 view .LVU277
 1095 0388 0E94 0000 		call waiting_buffer_scan_tap
 1096               	.LVL66:
 1097 038c 00C0      		rjmp .L126
 1098               	.LVL67:
 1099               	.L41:
 1100               	.LBB37:
 1101               	.LBB31:
 1102               		.loc 2 50 79 is_stmt 0 view .LVU278
 1103 038e 81E0      		ldi r24,lo8(1)
 1104 0390 8E25      		eor r24,r14
 1105 0392 00C0      		rjmp .L40
 1106               	.LBE31:
 1107               	.LBE37:
 1108               		.cfi_endproc
 1109               	.LFE8:
 1111               		.section	.text.get_tapping_term,"ax",@progbits
 1112               		.weak	get_tapping_term
 1114               	get_tapping_term:
 1115               	.LVL68:
 1116               	.LFB6:
  22:tmk_core/common/action_tapping.c **** 
 1117               		.loc 1 22 67 is_stmt 1 view -0
 1118               		.cfi_startproc
 1119               	/* prologue: function */
 1120               	/* frame size = 0 */
 1121               	/* stack size = 0 */
 1122               	.L__stack_usage = 0
  22:tmk_core/common/action_tapping.c **** 
 1123               		.loc 1 22 69 view .LVU280
  22:tmk_core/common/action_tapping.c **** 
 1124               		.loc 1 22 1 is_stmt 0 view .LVU281
 1125 0000 88EC      		ldi r24,lo8(-56)
 1126 0002 90E0      		ldi r25,0
 1127               	.LVL69:
 1128               	/* epilogue start */
  22:tmk_core/common/action_tapping.c **** 
 1129               		.loc 1 22 1 view .LVU282
 1130 0004 0895      		ret
 1131               		.cfi_endproc
 1132               	.LFE6:
 1134               		.section	.text.action_tapping_process,"ax",@progbits
 1135               	.global	action_tapping_process
 1137               	action_tapping_process:
 1138               	.LFB7:
  48:tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1139               		.loc 1 48 49 is_stmt 1 view -0
 1140               		.cfi_startproc
 1141 0000 CF93      		push r28
 1142               	.LCFI18:
 1143               		.cfi_def_cfa_offset 3
 1144               		.cfi_offset 28, -2
 1145 0002 DF93      		push r29
 1146               	.LCFI19:
 1147               		.cfi_def_cfa_offset 4
 1148               		.cfi_offset 29, -3
 1149 0004 CDB7      		in r28,__SP_L__
 1150 0006 DEB7      		in r29,__SP_H__
 1151               	.LCFI20:
 1152               		.cfi_def_cfa_register 28
 1153 0008 2C97      		sbiw r28,12
 1154               	.LCFI21:
 1155               		.cfi_def_cfa_offset 16
 1156 000a 0FB6      		in __tmp_reg__,__SREG__
 1157 000c F894      		cli
 1158 000e DEBF      		out __SP_H__,r29
 1159 0010 0FBE      		out __SREG__,__tmp_reg__
 1160 0012 CDBF      		out __SP_L__,r28
 1161               	/* prologue: function */
 1162               	/* frame size = 12 */
 1163               	/* stack size = 14 */
 1164               	.L__stack_usage = 14
 1165 0014 4F83      		std Y+7,r20
 1166 0016 5887      		std Y+8,r21
 1167 0018 6987      		std Y+9,r22
 1168 001a 7A87      		std Y+10,r23
 1169 001c 8B87      		std Y+11,r24
 1170 001e 9C87      		std Y+12,r25
  49:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1171               		.loc 1 49 5 view .LVU284
  49:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1172               		.loc 1 49 9 is_stmt 0 view .LVU285
 1173 0020 CE01      		movw r24,r28
 1174 0022 0796      		adiw r24,7
 1175 0024 0E94 0000 		call process_tapping
 1176               	.LVL70:
  49:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1177               		.loc 1 49 8 view .LVU286
 1178 0028 8823      		tst r24
 1179 002a 01F0      		breq .L134
  50:tmk_core/common/action_tapping.c ****             debug("processed: ");
 1180               		.loc 1 50 9 is_stmt 1 view .LVU287
 1181               	.LBB46:
 1182               	.LBI46:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1183               		.loc 2 48 20 view .LVU288
 1184               	.LBB47:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1185               		.loc 2 48 51 view .LVU289
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1186               		.loc 2 48 74 is_stmt 0 view .LVU290
 1187 002c 8A85      		ldd r24,Y+10
 1188 002e 9B85      		ldd r25,Y+11
 1189 0030 892B      		or r24,r25
 1190 0032 01F0      		breq .L142
 1191 0034 4F81      		ldd r20,Y+7
 1192 0036 5885      		ldd r21,Y+8
 1193 0038 842F      		mov r24,r20
 1194 003a 8523      		and r24,r21
 1195 003c 8F3F      		cpi r24,lo8(-1)
 1196 003e 01F0      		breq .+2
 1197 0040 00C0      		rjmp .L157
 1198               	.L142:
 1199               	.LBE47:
 1200               	.LBE46:
  69:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1201               		.loc 1 69 12 is_stmt 1 discriminator 1 view .LVU291
  69:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1202               		.loc 1 69 32 is_stmt 0 discriminator 1 view .LVU292
 1203 0042 8091 0000 		lds r24,waiting_buffer_tail
  69:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1204               		.loc 1 69 5 discriminator 1 view .LVU293
 1205 0046 9091 0000 		lds r25,waiting_buffer_head
 1206 004a 8913      		cpse r24,r25
 1207 004c 00C0      		rjmp .L140
 1208               	.L133:
 1209               	/* epilogue start */
  83:tmk_core/common/action_tapping.c **** 
 1210               		.loc 1 83 1 view .LVU294
 1211 004e 2C96      		adiw r28,12
 1212 0050 0FB6      		in __tmp_reg__,__SREG__
 1213 0052 F894      		cli
 1214 0054 DEBF      		out __SP_H__,r29
 1215 0056 0FBE      		out __SREG__,__tmp_reg__
 1216 0058 CDBF      		out __SP_L__,r28
 1217 005a DF91      		pop r29
 1218 005c CF91      		pop r28
 1219 005e 0895      		ret
 1220               	.L134:
  56:tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1221               		.loc 1 56 9 is_stmt 1 view .LVU295
 1222 0060 86E0      		ldi r24,lo8(6)
 1223 0062 FE01      		movw r30,r28
 1224 0064 3796      		adiw r30,7
 1225 0066 DE01      		movw r26,r28
 1226 0068 1196      		adiw r26,1
 1227               		0:
 1228 006a 0190      		ld r0,Z+
 1229 006c 0D92      		st X+,r0
 1230 006e 8A95      		dec r24
 1231 0070 01F4      		brne 0b
 1232               	.LVL71:
 1233               	.LBB48:
 1234               	.LBI48:
 302:tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 1235               		.loc 1 302 6 view .LVU296
 1236               	.LBB49:
 303:tmk_core/common/action_tapping.c ****         return true;
 1237               		.loc 1 303 5 view .LVU297
 1238               	.LBB50:
 1239               	.LBI50:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1240               		.loc 2 48 20 view .LVU298
 1241               	.LBB51:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1242               		.loc 2 48 51 view .LVU299
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1243               		.loc 2 48 74 is_stmt 0 view .LVU300
 1244 0072 8A85      		ldd r24,Y+10
 1245 0074 9B85      		ldd r25,Y+11
 1246 0076 892B      		or r24,r25
 1247 0078 01F0      		breq .L142
 1248 007a 8F81      		ldd r24,Y+7
 1249 007c 9885      		ldd r25,Y+8
 1250 007e 8923      		and r24,r25
 1251 0080 8F3F      		cpi r24,lo8(-1)
 1252 0082 01F0      		breq .L142
 1253               	.LBE51:
 1254               	.LBE50:
 307:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1255               		.loc 1 307 5 is_stmt 1 view .LVU301
 307:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1256               		.loc 1 307 30 is_stmt 0 view .LVU302
 1257 0084 8091 0000 		lds r24,waiting_buffer_head
 1258 0088 90E0      		ldi r25,0
 1259 008a 9C01      		movw r18,r24
 1260 008c 2F5F      		subi r18,-1
 1261 008e 3F4F      		sbci r19,-1
 307:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1262               		.loc 1 307 35 view .LVU303
 1263 0090 2770      		andi r18,7
 1264 0092 3327      		clr r19
 307:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1265               		.loc 1 307 57 view .LVU304
 1266 0094 4091 0000 		lds r20,waiting_buffer_tail
 307:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1267               		.loc 1 307 8 view .LVU305
 1268 0098 4217      		cp r20,r18
 1269 009a 1306      		cpc __zero_reg__,r19
 1270 009c 01F4      		brne .L159
 1271               	.LVL72:
 307:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1272               		.loc 1 307 8 view .LVU306
 1273               	.LBE49:
 1274               	.LBE48:
  58:tmk_core/common/action_tapping.c ****             clear_keyboard();
 1275               		.loc 1 58 50 is_stmt 1 view .LVU307
  59:tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
 1276               		.loc 1 59 13 view .LVU308
 1277 009e 0E94 0000 		call clear_keyboard
 1278               	.LVL73:
  60:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1279               		.loc 1 60 13 view .LVU309
 1280               	.LBB53:
 1281               	.LBI53:
 324:tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 1282               		.loc 1 324 6 view .LVU310
 1283               	.LBB54:
 325:tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1284               		.loc 1 325 5 view .LVU311
 325:tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1285               		.loc 1 325 25 is_stmt 0 view .LVU312
 1286 00a2 1092 0000 		sts waiting_buffer_head,__zero_reg__
 326:tmk_core/common/action_tapping.c **** }
 1287               		.loc 1 326 5 is_stmt 1 view .LVU313
 326:tmk_core/common/action_tapping.c **** }
 1288               		.loc 1 326 25 is_stmt 0 view .LVU314
 1289 00a6 1092 0000 		sts waiting_buffer_tail,__zero_reg__
 1290               	.LBE54:
 1291               	.LBE53:
  61:tmk_core/common/action_tapping.c ****         }
 1292               		.loc 1 61 13 is_stmt 1 view .LVU315
  61:tmk_core/common/action_tapping.c ****         }
 1293               		.loc 1 61 25 is_stmt 0 view .LVU316
 1294 00aa 86E0      		ldi r24,lo8(6)
 1295 00ac E0E0      		ldi r30,lo8(tapping_key)
 1296 00ae F0E0      		ldi r31,hi8(tapping_key)
 1297 00b0 DF01      		movw r26,r30
 1298               		0:
 1299 00b2 1D92      		st X+,__zero_reg__
 1300 00b4 8A95      		dec r24
 1301 00b6 01F4      		brne 0b
 1302 00b8 00C0      		rjmp .L142
 1303               	.LVL74:
 1304               	.L159:
 1305               	.LBB55:
 1306               	.LBB52:
 312:tmk_core/common/action_tapping.c ****     waiting_buffer_head                 = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1307               		.loc 1 312 5 is_stmt 1 view .LVU317
 312:tmk_core/common/action_tapping.c ****     waiting_buffer_head                 = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1308               		.loc 1 312 41 is_stmt 0 view .LVU318
 1309 00ba 66E0      		ldi r22,lo8(6)
 1310 00bc 70E0      		ldi r23,0
 1311 00be 0E94 0000 		call __mulhi3
 1312 00c2 DC01      		movw r26,r24
 1313 00c4 A050      		subi r26,lo8(-(waiting_buffer))
 1314 00c6 B040      		sbci r27,hi8(-(waiting_buffer))
 1315 00c8 96E0      		ldi r25,lo8(6)
 1316 00ca FE01      		movw r30,r28
 1317 00cc 3196      		adiw r30,1
 1318               		0:
 1319 00ce 0190      		ld r0,Z+
 1320 00d0 0D92      		st X+,r0
 1321 00d2 9A95      		dec r25
 1322 00d4 01F4      		brne 0b
 313:tmk_core/common/action_tapping.c **** 
 1323               		.loc 1 313 5 is_stmt 1 view .LVU319
 313:tmk_core/common/action_tapping.c **** 
 1324               		.loc 1 313 41 is_stmt 0 view .LVU320
 1325 00d6 2093 0000 		sts waiting_buffer_head,r18
 315:tmk_core/common/action_tapping.c ****     debug_waiting_buffer();
 1326               		.loc 1 315 34 is_stmt 1 view .LVU321
 316:tmk_core/common/action_tapping.c ****     return true;
 1327               		.loc 1 316 5 view .LVU322
 1328 00da 0E94 0000 		call debug_waiting_buffer
 1329               	.LVL75:
 317:tmk_core/common/action_tapping.c **** }
 1330               		.loc 1 317 5 view .LVU323
 317:tmk_core/common/action_tapping.c **** }
 1331               		.loc 1 317 5 is_stmt 0 view .LVU324
 1332 00de 00C0      		rjmp .L142
 1333               	.L140:
 317:tmk_core/common/action_tapping.c **** }
 1334               		.loc 1 317 5 view .LVU325
 1335               	.LBE52:
 1336               	.LBE55:
  70:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
 1337               		.loc 1 70 9 is_stmt 1 view .LVU326
  70:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
 1338               		.loc 1 70 13 is_stmt 0 view .LVU327
 1339 00e0 90E0      		ldi r25,0
 1340 00e2 66E0      		ldi r22,lo8(6)
 1341 00e4 70E0      		ldi r23,0
 1342 00e6 0E94 0000 		call __mulhi3
 1343 00ea 8050      		subi r24,lo8(-(waiting_buffer))
 1344 00ec 9040      		sbci r25,hi8(-(waiting_buffer))
 1345 00ee 0E94 0000 		call process_tapping
 1346               	.LVL76:
  70:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
 1347               		.loc 1 70 12 view .LVU328
 1348 00f2 8823      		tst r24
 1349 00f4 01F4      		brne .+2
 1350 00f6 00C0      		rjmp .L133
  71:tmk_core/common/action_tapping.c ****             debug_dec(waiting_buffer_tail);
 1351               		.loc 1 71 48 is_stmt 1 view .LVU329
  72:tmk_core/common/action_tapping.c ****             debug("] = ");
 1352               		.loc 1 72 43 view .LVU330
  73:tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]);
 1353               		.loc 1 73 26 view .LVU331
  74:tmk_core/common/action_tapping.c ****             debug("\n\n");
 1354               		.loc 1 74 13 view .LVU332
 1355 00f8 8091 0000 		lds r24,waiting_buffer_tail
 1356 00fc 90E0      		ldi r25,0
 1357 00fe 66E0      		ldi r22,lo8(6)
 1358 0100 70E0      		ldi r23,0
 1359 0102 0E94 0000 		call __mulhi3
 1360 0106 FC01      		movw r30,r24
 1361 0108 E050      		subi r30,lo8(-(waiting_buffer))
 1362 010a F040      		sbci r31,hi8(-(waiting_buffer))
 1363 010c 4081      		ld r20,Z
 1364 010e 5181      		ldd r21,Z+1
 1365 0110 6281      		ldd r22,Z+2
 1366 0112 7381      		ldd r23,Z+3
 1367 0114 8481      		ldd r24,Z+4
 1368 0116 9581      		ldd r25,Z+5
 1369 0118 0E94 0000 		call debug_record
 1370               	.LVL77:
  75:tmk_core/common/action_tapping.c ****         } else {
 1371               		.loc 1 75 26 view .LVU333
  69:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1372               		.loc 1 69 56 view .LVU334
  69:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1373               		.loc 1 69 99 is_stmt 0 view .LVU335
 1374 011c 8091 0000 		lds r24,waiting_buffer_tail
 1375 0120 90E0      		ldi r25,0
 1376 0122 0196      		adiw r24,1
  69:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1377               		.loc 1 69 104 view .LVU336
 1378 0124 8770      		andi r24,7
 1379 0126 9927      		clr r25
  69:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1380               		.loc 1 69 76 view .LVU337
 1381 0128 8093 0000 		sts waiting_buffer_tail,r24
 1382 012c 00C0      		rjmp .L142
 1383               	.L157:
  51:tmk_core/common/action_tapping.c ****             debug_record(record);
 1384               		.loc 1 51 33 is_stmt 1 view .LVU338
  52:tmk_core/common/action_tapping.c ****             debug("\n");
 1385               		.loc 1 52 13 view .LVU339
 1386 012e 6985      		ldd r22,Y+9
 1387 0130 7A85      		ldd r23,Y+10
 1388 0132 8B85      		ldd r24,Y+11
 1389 0134 9C85      		ldd r25,Y+12
 1390 0136 0E94 0000 		call debug_record
 1391               	.LVL78:
 1392 013a 00C0      		rjmp .L142
 1393               		.cfi_endproc
 1394               	.LFE7:
 1396               		.section	.bss.waiting_buffer_tail,"aw",@nobits
 1399               	waiting_buffer_tail:
 1400 0000 00        		.zero	1
 1401               		.section	.bss.waiting_buffer_head,"aw",@nobits
 1404               	waiting_buffer_head:
 1405 0000 00        		.zero	1
 1406               		.section	.bss.waiting_buffer,"aw",@nobits
 1409               	waiting_buffer:
 1410 0000 0000 0000 		.zero	48
 1410      0000 0000 
 1410      0000 0000 
 1410      0000 0000 
 1410      0000 0000 
 1411               		.section	.bss.tapping_key,"aw",@nobits
 1414               	tapping_key:
 1415 0000 0000 0000 		.zero	6
 1415      0000 
 1416               		.text
 1417               	.Letext0:
 1418               		.file 3 "/usr/local/Cellar/avr-gcc@8/8.4.0/avr/include/stdint.h"
 1419               		.file 4 "tmk_core/common/keycode.h"
 1420               		.file 5 "tmk_core/common/action_code.h"
 1421               		.file 6 "tmk_core/common/action.h"
 1422               		.file 7 "tmk_core/common/action_layer.h"
 1423               		.file 8 "tmk_core/common/timer.h"
 1424               		.file 9 "tmk_core/common/avr/xprintf.h"
 1425               		.file 10 "tmk_core/common/debug.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 action_tapping.c
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:2      *ABS*:000000000000003e __SP_H__
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:3      *ABS*:000000000000003d __SP_L__
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:4      *ABS*:000000000000003f __SREG__
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:5      *ABS*:0000000000000000 __tmp_reg__
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:6      *ABS*:0000000000000001 __zero_reg__
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:12     .text.debug_waiting_buffer:0000000000000000 debug_waiting_buffer
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:1399   .bss.waiting_buffer_tail:0000000000000000 waiting_buffer_tail
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:1404   .bss.waiting_buffer_head:0000000000000000 waiting_buffer_head
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:1409   .bss.waiting_buffer:0000000000000000 waiting_buffer
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:88     .text.debug_tapping_key:0000000000000000 debug_tapping_key
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:1414   .bss.tapping_key:0000000000000000 tapping_key
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:111    .text.waiting_buffer_scan_tap:0000000000000000 waiting_buffer_scan_tap
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:306    .text.process_tapping:0000000000000000 process_tapping
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:1114   .text.get_tapping_term:0000000000000000 get_tapping_term
/var/folders/hg/m293bnw975q820z9tg0f9gdw0000gn/T//ccRbAEIS.s:1137   .text.action_tapping_process:0000000000000000 action_tapping_process

UNDEFINED SYMBOLS
__mulhi3
debug_record
process_record
layer_switch_get_action
is_tap_key
debug_event
process_record_tap_hint
clear_keyboard
__do_clear_bss
